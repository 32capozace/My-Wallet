function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromSatoshi(a){return Bitcoin.Util.formatValue(a.multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function precisionFromBTC(a){return precisionFromSatoshi(Bitcoin.Util.parseValue(a))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var h=this;this.skip_init=false;var D="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var aj;var M;var j;var aK;var al;var w;var d;var aA=0;var S=0;var au=0;var K=0;var aV=0;var aI;var g={};var E=[];var F=false;var ay=0;var at=0;var aD=1000;var I={};var aB;var an;var x=0.5;var ag=10;var P=ag;var b={};var q;var aQ=0;var U;var Z=[];var B;var N=60000;var A=false;var aa;var ar=false;var X="en";var ap=2;var Q=0;var aN=0;var Y=false;var aF;var aq=false;var T=false;var ax=false;var s={pbkdf2_iterations:ag,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false,transactions_per_page:30,additional_seeds:[]};this.setEncryptedWalletData=function(aX){if(!aX||aX.length==0){aj=null;aB=null;return}aj=aX;aB=ah();try{if(aQ==0||s.always_keep_local_backup){MyStore.put("payload",aj)}}catch(aY){console.log(aY)}};this.setRealAuthType=function(aX){aQ=aX};this.addAdditionalSeeds=function(aX){s.additional_seeds.push(aX)};this.getAdditionalSeeds=function(aX){return s.additional_seeds};this.getLanguage=function(){return X};this.setLanguage=function(aX){MyStore.put("language",aX);X=aX};this.addEventListener=function(aX){Z.push(aX)};this.getLogoutTime=function(){return s.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return s.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return P};this.getDefaultPbkdf2Iterations=function(){return ag};this.getSharedcoinEndpoint=function(){return aF};this.disableLogout=function(aX){aq=aX};this.setLogoutTime=function(aX){s.logout_time=aX;clearInterval(U);U=setTimeout(h.logout,h.getLogoutTime())};this.getDoubleEncryption=function(){return F};this.getEncryptedWalletData=function(){return aj};this.getFeePolicy=function(){return s.fee_policy};this.setFeePolicy=function(aX){s.fee_policy=parseInt(aX)};this.setAlwaysKeepLocalBackup=function(aX){s.always_keep_local_backup=aX};this.getAlwaysKeepLocalBackup=function(){return s.always_keep_local_backup};this.setNTransactionsPerPage=function(aX){s.transactions_per_page=aX};this.getNTransactionsPerPage=function(){return s.transactions_per_page};this.getGuid=function(){return M};this.getHTML5Notifications=function(){return s.html5_notifications};this.setHTML5Notifications=function(aX){s.html5_notifications=aX};this.getTransactions=function(){return E};this.addressExists=function(aX){return I[aX]!=null};this.getAddressTag=function(aX){return I[aX].tag};this.setAddressTag=function(aY,aX){I[aY].tag=aX};this.getAddressBook=function(){return g};this.getAddressLabel=function(aX){return I[aX].label};this.setAddressLabel=function(aX,aY){I[aX].label=aY};this.setAddressBalance=function(aX,aY){I[aX].balance=aY};this.getAddressBookLabel=function(aX){return g[aX]};this.isWatchOnly=function(aX){return !I[aX]||I[aX].priv==null};this.getAddressBalance=function(aX){return I[aX].balance};this.getMixerFee=function(){return x};this.deleteAddress=function(aX){delete I[aX]};this.addAddressBookEntry=function(aY,aX){g[aY]=aX};this.getPrivateKey=function(aX){return I[aX].priv};this.setLabel=function(aX,aY){I[aX].label=aY;ai();c()};this.securePost=function(aX,a0,a7,a4){var a3=jQuery.extend({},a0);if(!a0.sharedKey){if(!d||d.length==0||d.length!=36){throw"Shared key is invalid"}var aY=new Date().getTime();var a2=parseInt((aY-aN)/10000);var a1=Crypto.SHA256(d.toLowerCase()+a2);var aZ=0;var a6=a1.substring(aZ,aZ+=8)+"-"+a1.substring(aZ,aZ+=4)+"-"+a1.substring(aZ,aZ+=4)+"-"+a1.substring(aZ,aZ+=4)+"-"+a1.substring(aZ,aZ+=12);a3.sharedKey=a6;a3.sKTimestamp=a2;a3.sKDebugHexHash=a1;a3.sKDebugTimeOffset=aN;a3.sKDebugOriginalClientTime=aY;a3.sKDebugOriginalSharedKey=d}if(!a0.guid){a3.guid=M}a3.format=a0.format?a0.format:"plain";var a5="text";if(a0.format=="json"){a5="json"}$.ajax({dataType:a5,type:"POST",url:root+aX,data:a3,success:a7,error:a4})};this.isCorrectMainPassword=function(aX){return aK==aX};function ae(aY,a0){var aX=Crypto.SHA256(aY,{asBytes:true});for(var aZ=1;aZ<a0;++aZ){aX=Crypto.SHA256(aX,{asBytes:true})}return Crypto.util.bytesToHex(aX)}this.setPbkdf2Iterations=function(aX,aZ){var aY=function(a0){console.log("Panic "+a0);window.location.reload()};h.getSecondPassword(function(){try{if(F){for(var a0 in I){var a2=I[a0];if(a2.priv){a2.priv=h.encrypt(h.decryptPK(a2.priv),d+al,aX);if(!a2.priv){throw"addr.priv is null"}}}s.pbkdf2_iterations=aX;w=ae(d+al,aX)}Q=2;P=aX;h.backupWallet("update",function(){aZ()},function(){aY(a1)})}catch(a1){aY(a1)}},function(a0){aY(a0)})};this.setDoubleEncryption=function(aZ,aX,a1){var aY=function(a2){console.log("Panic "+a2);window.location.reload()};try{if(F==aZ){return}if(aZ){h.getSecondPassword(function(){try{F=true;al=aX;for(var a2 in I){var a4=I[a2];if(a4.priv){a4.priv=i(B58.decode(a4.priv));if(!a4.priv){throw"addr.priv is null"}}}w=ae(d+al,s.pbkdf2_iterations);al=null;h.getSecondPassword(function(){try{h.checkAllKeys();h.backupWallet("update",function(){a1()},function(){aY(a5)})}catch(a5){aY(a5)}},function(a5){aY(a5)})}catch(a3){aY(a3)}},function(a2){aY(a2)})}else{h.getSecondPassword(function(){try{for(var a2 in I){var a4=I[a2];if(a4.priv){a4.priv=h.decryptPK(a4.priv);if(!a4.priv){throw"addr.priv is null"}}}F=false;al=null;h.checkAllKeys();h.backupWallet("update",function(){a1()},function(){aY(a3)})}catch(a3){aY(a3)}},function(a2){aY(a2)})}}catch(a0){aY(a0)}};this.unArchiveAddr=function(aX){var aX=I[aX];if(aX.tag==2){aX.tag=null;c();ai("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(aX){if(h.getActiveAddresses().length<=1){h.makeNotice("error","add-error","You must leave at least one active address");return}var aX=I[aX];if(aX.tag==null||aX.tag==0){aX.tag=2;c();ai("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(aX){return aT(aX)};this.addPrivateKey=function(aX,aZ){if(ak()){return false}if(aX==null){throw"Cannot add null key."}if(aZ==null){aZ={}}var a2=aZ.compressed?aX.getBitcoinAddressCompressed().toString():aX.getBitcoinAddress().toString();var a1=i(aX.priv);if(a1==null){throw"Error Encoding key"}var aY=new Bitcoin.ECKey(h.decodePK(a1));if(a2!=aY.getBitcoinAddress().toString()&&a2!=aY.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aT(a2,a1)){I[a2].tag=1;I[a2].created_time=aZ.created_time?aZ.created_time:0;I[a2].created_device_name=aZ.app_name?aZ.app_name:APP_NAME;I[a2].created_device_version=aZ.app_version?aZ.app_version:APP_VERSION;if(I[a2].priv!=a1){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+a2+'"}')}catch(a0){}}else{throw"Unable to add generated bitcoin address."}return a2};this._seed=function(aZ){rng_seed_time();if(aK||aZ){var aX=Crypto.util.bytesToWords(Crypto.SHA256(aK?aK:aZ,{asBytes:true}));for(var aY in aX){rng_seed_int(aX[aY])}}if(!aa){aa=$("body").data("extra-seed")}if(aa){var aX=Crypto.util.bytesToWords(Crypto.util.hexToBytes(aa));for(var aY in aX){rng_seed_int(aX[aY])}}};this.generateNewKey=function(aY){h._seed(aY);var aX=new Bitcoin.ECKey(false);if(h.addPrivateKey(aX)){return aX}};this.setLoadingText=function(aX){$(".loading-text").text(aX)};function L(){try{$(".popover").remove()}catch(aX){}}$(window).resize(function(){$(".modal:visible").center();L()});function aS(aY,aX){aY.click(function(){z(aX.txIndex,aX.result)});aY.find(".show-note").mouseover(function(){var aZ=aX.note?aX.note:b[aX.hash];aM(this,aZ,aX.hash)});aY.find(".add-note").mouseover(function(){m(this,aX.hash)});return aY}function t(aY,a4){var aX=0;for(var a0=0;a0<aY.inputs.length;++a0){var aZ=aY.inputs[a0].prev_out;if(!aZ||!aZ.addr){continue}var a3=I[aZ.addr];if(a3){var a2=parseInt(aZ.value);aX-=a2;if(a4){S+=a2;a3.balance-=a2}}}for(var a1=0;a1<aY.out.length;++a1){var aZ=aY.out[a1];if(!aZ||!aZ.addr){continue}var a3=I[aZ.addr];if(a3){var a2=parseInt(aZ.value);aX+=a2;if(a4){au+=a2;a3.balance+=a2}}}return aX}function ah(){return Crypto.util.bytesToHex(Crypto.SHA256(aj,{asBytes:true}))}function y(aX){var aY=null;aX.onmessage=function(a5){try{var a2=$.parseJSON(a5.data);if(a2.op=="on_change"){var a6=ah();var a4=a2.checksum;console.log("On change old "+a6+" ==  new "+a4);if(aY!=a4&&a6!=a4){aY=a4;J()}}else{if(a2.op=="utx"){var a3=TransactionFromJSON(a2.x);for(var a8 in E){if(E[a8].txIndex==a3.txIndex){return}}var ba=t(a3,true);if(h.getHTML5Notifications()){h.showNotification({title:ba>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(ba),iconUrl:resource+"cube48.png"})}a3.result=ba;aA+=ba;K++;a3.setConfirmations(0);playSound("beep");if(at==0&&ay==0){E.unshift(a3);var a7=false;if(E.length>h.getNTransactionsPerPage()){E.pop();a7=true}}var a0=V();if("my-transactions"==a0){if(at==0&&ay==0){$("#no-transactions").hide();if(s.tx_display==0){var aZ=$("#transactions-compact").show();aS($(C(a3,I,g)),a3).prependTo(aZ.find("tbody")).find("div").hide().slideDown("slow");if(a7){aZ.find("tbody tr:last-child").remove()}}else{var aZ=$("#transactions-detailed").show();aZ.prepend(a3.getHTML(I,g));if(a7){aZ.find("div:last-child").remove()}setupSymbolToggle()}}}else{c()}}else{if(a2.op=="block"){for(var a1=0;a1<a2.x.txIndexes.length;++a1){for(var a9=0;a9<E.length;++a9){if(E[a9].txIndex==a2.x.txIndexes[a1]){if(E[a9].blockHeight==null||E[a9].blockHeight==0){E[a9].blockHeight=a2.x.height;break}}}}az(BlockFromJSON(a2.x));W()}}}}catch(a5){console.log(a5);console.log(a5.data)}};aX.onopen=function(){av("ok");var a2='{"op":"blocks_sub"}';if(M!=null){a2+='{"op":"wallet_sub","guid":"'+M+'"}'}try{var a0=h.getActiveAddresses();for(var aZ in a0){a2+='{"op":"addr_sub", "addr":"'+a0[aZ]+'"}'}}catch(a1){alert(a1)}aX.send(a2)};aX.onclose=function(){av("error")}}var aR="ok";function av(aY){var aX=$("#logout");if(aY=="loading_start"){aX.attr("src",resource+"logout-orange.png");return}else{if(aY!="loading_stop"){aR=aY}}if(aR=="ok"){aX.attr("src",resource+"logout.png")}else{if(aR=="error"){aX.attr("src",resource+"logout-red.png")}}}this.showNotification=function(aX,aY){try{var a0;if(window.webkitNotifications&&webkitNotifications.checkPermission()==0){a0=webkitNotifications.createNotification(aX.iconUrl,aX.title,aX.body);a0.show()}else{if(window.Notification&&window.Notification.permissionLevel()=="granted"){a0=new window.Notification(aX.title,aX).show()}}setTimeout(function(){a0.cancel()},aY?aY:5000)}catch(aZ){}};this.makeNotice=function(aY,a1,a0,aZ){if(a0==null||a0.length==0){return}console.log(a0);var aX=$('<div class="alert alert-block alert-'+aY+'"></div>');aX.text(""+a0);if($("#"+a1).length>0){aX.attr("id",a1);return}$("#notices").append(aX).hide().fadeIn(200);(function(){var a2=aX;setTimeout(function(){a2.fadeOut(250,function(){$(this).remove()})},aZ?aZ:5000)})()};this.pkBytesToSipa=function(aX,a1){var aY=new Bitcoin.ECKey(aX);while(aX.length<32){aX.unshift(0)}aX.unshift(128);if(aY.getBitcoinAddress().toString()==a1){}else{if(aY.getBitcoinAddressCompressed().toString()==a1){aX.push(1)}else{throw"Private Key does not match bitcoin address"+a1}}var aZ=Crypto.SHA256(Crypto.SHA256(aX,{asBytes:true}),{asBytes:true});aX=aX.concat(aZ.slice(0,4));var a0=B58.encode(aX);return a0};function aH(aX){return aX}function aw(aX){return h.decryptPK(aX)}function ac(aX){var aY=h.decodePK(aX);return Crypto.util.bytesToBase64(aY)}function k(aX){var aY=h.decodePK(aX);return Crypto.util.bytesToHex(aY)}this.base58ToSipa=function(aX,aY){return h.pkBytesToSipa(h.decodePK(aX),aY)};this.makeWalletJSON=function(aX){return h.makeCustomWalletJSON(aX,M,d)};this.makeCustomWalletJSON=function(a2,aY,a4){var a1=aH;if(a2=="base64"){a1=ac}else{if(a2=="hex"){a1=k}else{if(a2=="sipa"){a1=h.base58ToSipa}else{if(a2=="base58"){a1=aw}}}}var aX='{\n	"guid" : "'+aY+'",\n	"sharedKey" : "'+a4+'",\n';if(F&&w!=null&&a1==aH){aX+='	"double_encryption" : '+F+',\n	"dpasswordhash" : "'+w+'",\n'}if(s){aX+='	"options" : '+JSON.stringify(s)+",\n"}aX+='	"keys" : [\n';for(var a0 in I){var a3=$.extend({},I[a0]);if(a3.tag==1){delete a3.tag}if(a3.priv!=null){a3.priv=a1(a3.priv,a3.addr)}for(var aZ in a3){if(a3[aZ]===null||a3[aZ]===undefined){delete a3[aZ]}}delete a3.balance;aX+=JSON.stringify(a3)+",\n";atLeastOne=true}if(atLeastOne){aX=aX.substring(0,aX.length-2)}aX+="\n	]";if(aG(g)>0){aX+=',\n	"address_book" : [\n';for(var a0 in g){aX+='	{"addr" : "'+a0+'",\n';aX+='	 "label" : "'+g[a0]+'"},\n'}aX=aX.substring(0,aX.length-2);aX+="\n	]"}if(aG(b)>0){aX+=',\n	"tx_notes" : '+JSON.stringify(b)}aX+="\n}";return aX};this.get_history=function(aY,aX){BlockchainAPI.get_history(function(aZ){H(aZ,false);if(E.length==0&&ay>0){h.setPage(0)}else{c()}if(aY){aY()}},function(){if(aX){aX()}},at,ay*h.getNTransactionsPerPage(),h.getNTransactionsPerPage())};this.deleteAddressBook=function(aX){delete g[aX];ai();$("#send-coins").find(".tab-pane").trigger("show",true)};function u(aX){$("#send-coins").find(".tab-pane.active").trigger("show",aX);if(aX){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function l(aX,aY,a2){var a1=aX.val();aX.empty();for(var a0 in I){var a3=I[a0];if(!a3||a3.tag==2){continue}var aZ=a3.label;if(!aZ){aZ=a3.addr.substring(0,15)+"..."}if(aY||a3.balance>0){aX.prepend('<option value="'+a3.addr+'">'+aZ+" - "+formatBTC(a3.balance)+"</option>")}}aX.prepend('<option value="any" selected>Any Address</option>');if(!a2&&a1){aX.val(a1)}}function r(aZ,a0){l(aZ.find('select[name="from"]'),false,a0);l(aZ.find('select[name="change"]'),true,a0);aZ.find('select[name="change"]').prepend('<option value="new">New Address</option>');aZ.find(".local-symbol").text(symbol_local.symbol);aZ.find(".btc-symbol").text(symbol_btc.symbol);if(a0){aZ.find("input").val("");aZ.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");aZ.find(".amount-needed").text(0)}var aY=aZ.find(".recipient-container");if(a0){var a2=aY.find(".recipient:first-child").clone();aY.empty().append(a2)}function aX(){var a3=BigInteger.ZERO;aZ.find(".send-value").each(function(){a3=a3.add(precisionToSatoshiBN($(this).val()))});return a3}function a1(a3){a3.find('input[name="send-to-address"]').typeahead({source:aC()}).next().unbind().click(function(){var a4=$(this).prev();h.scanQRCode(function(a5){console.log(a5);try{new Bitcoin.Address(a5);a4.val(a5)}catch(a6){h.handleURI(a5,a3)}},function(a5){h.makeNotice("error","misc-error",a5)})});a3.find(".send-value").unbind().bind("keyup change",function(a4){if(a4.keyCode=="9"){return}aZ.find(".amount-needed").text(formatBTC(aX().toString()));a3.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});a3.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(a4){if(a4.keyCode=="9"){return}a3.find(".send-value").val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}aY.find(".recipient").each(function(){a1($(this))});aZ.find(".remove-recipient").unbind().click(function(){var a3=aY.find(".recipient").length;if(a3>1){if(a3==2){$(this).hide(200)}aY.find(".recipient:last-child").remove()}});aZ.find(".add-recipient").unbind().click(function(){var a3=aY.find(".recipient:first-child").clone();a3.appendTo(aY);a1(a3);aZ.find(".remove-recipient").show(200)});aZ.find('select[name="from"]').unbind().change(function(){var a5=0;var a3=$(this).val();for(var a4 in a3){if(a3[a4]=="any"){$(this).val("any");a5=aA;break}else{var a6=I[a3[a4]];if(a6&&a6.balance){a5+=a6.balance}}}aZ.find(".amount-available").text(formatBTC(a5))}).trigger("change")}this.getAllAddresses=function(){var aY=[];for(var aX in I){aY.push(aX)}return aY};this.getPreferredAddress=function(){var aY=null;for(var aX in I){var aZ=I[aX];if(aY==null){aY=aZ}if(aZ.priv!=null){if(aY==null){aY=aZ}if(aZ.tag==null||aZ.tag==0){aY=aZ;break}}}return aY.addr};function aU(){var aX=$("#restore-backup-modal");aX.modal({keyboard:true,backdrop:"static",show:true});aX.find(".btn.btn-secondary").unbind().click(function(){aX.modal("hide")})}this.scanQRCode=function(aZ,aX){var aY=$("#qr-code-reader-modal");aY.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(aY,function(a0){aY.modal("hide");aZ(a0)},function(a0){aY.modal("hide");aX(a0)})},aX);aY.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();aY.modal("hide");aX()})};this.getActiveAddresses=function(){var aZ=[];for(var aX in I){var aY=I[aX];if(aY.tag!=2){aZ.push(aY.addr)}}return aZ};this.getArchivedAddresses=function(){var aZ=[];for(var aX in I){var aY=I[aX];if(aY.tag==2){aZ.push(aY.addr)}}return aZ};function az(a0){if(a0!=null){aI=a0;for(var aY in E){var aX=E[aY];if(aX.blockHeight!=null&&aX.blockHeight>0){var aZ=aI.height-aX.blockHeight+1;if(aZ<=100){aX.setConfirmations(aI.height-aX.blockHeight+1)}else{aX.setConfirmations(null)}}else{aX.setConfirmations(0)}}}}function z(aY,aX){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+aY+"?result="+aX+"&guid="+M})})}this.deleteNote=function(aX){delete b[aX];c();ai()};function m(aX,aY){(function(a0,a2){a0=$(a0);if(!a0.data("popover")){a0.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'})}else{if(a0.data("popover").tip().is(":visible")){return}}a0.popover("show");a0.mouseleave(function(){if(!a0.__timeout){a0.__timeout=setTimeout(function(){a0.popover("hide")},250)}});function aZ(){if(a0.__timeout){clearTimeout(a0.__timeout);a0.__timeout=null}}var a1=a0.data("popover").tip().mouseenter(aZ);a1.find("textarea").focus(aZ);a1.mouseleave(function(){a0.__timeout=setTimeout(function(){a0.popover("hide")},250)});a1.find("i").unbind().click(function(){a0.popover("hide")});a1.find("button").click(function(){var a3=stripHTML(a1.find("textarea").val()).replace(/'/g,"").replace(/"/g,"");a3=a3.replace(/(\r\n|\n|\r)/gm,"");if(a3.length>0){b[a2]=a3;ai()}c()})})(aX,aY)}function aM(aX,aY,aZ){(function(a0,a1,a3){a0=$(a0);if(!a0.data("popover")){var a4="Note";if(b[a3]){a4+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}$(a0).popover({title:a4,trigger:"manual",content:$("<div/>").html(a1).text()})}else{if(a0.data("popover").tip().is(":visible")){return}}a0.popover("show");a0.mouseleave(function(){if(!a0.__timeout){a0.__timeout=setTimeout(function(){a0.popover("hide")},250)}});var a2=a0.data("popover").tip().mouseenter(function(){if(a0.__timeout){clearTimeout(a0.__timeout);a0.__timeout=null}});a2.find("img").unbind().click(function(){h.deleteNote(a3)});a2.mouseleave(function(){a0.__timeout=setTimeout(function(){a0.popover("hide")},250)})})(aX,aY,aZ)}function C(a0,a5,a2){var a6=a0.result;var a1='<tr class="pointer" id="tx-'+a0.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var aY=true;if(a6>=0){for(var aZ=0;aZ<a0.inputs.length;++aZ){var aX=a0.inputs[aZ].prev_out;if(!aX||!aX.addr){aY=false;a1+='<span class="label">Newly Generated Coins</span>'}else{var a3=a5[aX.addr];if(a3){continue}aY=false;a1+=formatOutput(aX,a5,a2)}}}else{if(a6<0){for(var aZ=0;aZ<a0.out.length;++aZ){var aX=a0.out[aZ];var a3=a5[aX.addr];if(a3&&aX.type==0){continue}aY=false;a1+=formatOutput(aX,a5,a2)}}}if(aY){a1+='<span class="label">Moved Between Wallet</info>'}a1+="</ul></div></td><td><div>";var a4=a0.note?a0.note:b[a0.hash];if(a4){a1+='<img src="'+resource+'note.png" class="show-note"> '}else{a1+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(a0.time>0){a1+=dateToString(new Date(a0.time*1000))}if(a0.confirmations==0){a1+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(a0.confirmations>0){a1+=' <span class="label label-info hidden-phone">'+a0.confirmations+" Confirmations</span> "}}a1+="</div></td>";if(a6>0){a1+='<td style="color:green"><div>'+formatMoney(a6,true)+"</div></td>"}else{if(a6<0){a1+='<td style="color:red"><div>'+formatMoney(a6,true)+"</div></td>"}else{a1+="<td><div>"+formatMoney(a6,true)+"</div></td>"}}if(a0.balance==null){a1+="<td></td></tr>"}else{a1+='<td class="hidden-phone"><div>'+formatMoney(a0.balance)+"</div></td></tr>"}return a1}function V(){L();if(aA==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(aA,symbol,true));$("#balance2").html(formatSymbol(aA,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return j.attr("id")}function c(aX){var aY=V();if("send-coins"==aY){u(aX)}else{if("home-intro"==aY){f(aX)}else{if("receive-coins"==aY){aW(aX)}else{if("my-transactions"==aY){W(aX)}}}}}function f(aX){$("#summary-n-tx").html(K);$("#summary-received").html(formatMoney(au,true));$("#summary-sent").html(formatMoney(S,true));$("#summary-balance").html(formatMoney(aA,symbol));var aZ=h.getPreferredAddress();$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});if(h.isWatchOnly(aZ)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var aY=$("#my-primary-address");if(aY.text()!=aZ){aY.text(aZ);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:aZ})})}}}function R(){var aX=$("#export-warning").show();var aY=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){h.getMainPassword(function(){aX.hide();loadScript("wallet/import-export",function(){ImportExport.init(aY,function(){aY.show()},function(){af($("#home-intro"))})},function(aZ){h.makeNotice("error","misc-error",aZ);af($("#home-intro"))})},function(){af($("#home-intro"))})})}function W(){var aY=null;var a0=0;if(aY!=null){clearInterval(aY);aY=null}var aX;if(s.tx_display==0){$("#transactions-detailed").hide();aX=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();aX=$("#transactions-detailed").empty().show()}if(E.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var aZ=function(){for(var a4=a0;a4<E.length&&a4<(a0+h.getNTransactionsPerPage());++a4){var a3=E[a4];if(s.tx_display==0){aX.append(aS($(C(a3,I,g)),a3))}else{aX.append(a3.getHTML(I,g))}}a0+=h.getNTransactionsPerPage();if(a0<E.length){aY=setTimeout(aZ,15)}else{setupSymbolToggle();L();var a2=$(".pagination ul").empty();if(ay==0&&E.length<h.getNTransactionsPerPage()){a2.hide();return}else{a2.show()}var a1=Math.ceil(aV/h.getNTransactionsPerPage());var a6=" disabled";if(ay>0){a6=""}var a7=10;var a5=Math.max(0,Math.min(ay-(a7/2),a1-a7));a2.append($('<li class="prev'+a6+'"><a>&larr; Previous</a></li>').click(function(){h.setPage(ay-1)}));if(a5>0){a2.append($("<li><a>≤</a></li>").click(function(){h.setPage(0)}))}for(var a4=a5;a4<a1&&a4<a5+a7;++a4){(function(a8){var a9="";if(ay==a8){a9=' class="active"'}a2.append($("<li"+a9+'><a class="hidden-phone">'+(a8+1)+"</a></li>").click(function(){h.setPage(a8)}))})(a4)}if(a5+a7<a1){a2.append($("<li><a>≥</a></li>").click(function(){h.setPage(a1-1)}))}var a6=" disabled";if(ay<a1-1){a6=""}a2.append($('<li class="next'+a6+'"><a>Next &rarr;</a></li>').click(function(){h.setPage(ay+1)}))}};aZ()}this.setPage=function(aX){ay=aX;scroll(0,0);h.get_history()};function v(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+h.getActiveAddresses().join("|")+"&archived="+h.getArchivedAddresses().join("|")})})}function H(a0,aZ){if(!aZ&&a0.mixer_fee){x=a0.mixer_fee}if(a0.disable_mixer){$("#shared-addresses,#send-shared").hide()}aF=a0.sharedcoin_endpoint;E.length=0;if(a0.wallet==null){au=0;S=0;aA=0;K=0;aV=0;return}au=a0.wallet.total_received;S=a0.wallet.total_sent;aA=a0.wallet.final_balance;K=a0.wallet.n_tx;aV=a0.wallet.n_tx_filtered;for(var aY=0;aY<a0.addresses.length;++aY){if(I[a0.addresses[aY].address]){I[a0.addresses[aY].address].balance=a0.addresses[aY].final_balance}}for(var aY=0;aY<a0.txs.length;++aY){var aX=TransactionFromJSON(a0.txs[aY]);aX.result=t(aX,false);E.push(aX)}if(a0.info){$("#nodes-connected").html(a0.info.nconnected);if(a0.info.latest_block){az(a0.info.latest_block)}if(a0.info.symbol_local){setLocalSymbol(a0.info.symbol_local)}if(a0.info.symbol_btc){setBTCSymbol(a0.info.symbol_btc)}}}this.handleURI=function(aY,aX){loadScript("wallet/jsuri-1.1.1",function(){try{var a0=new Uri(aY);var aZ=new Bitcoin.Address(a0.host());aX.find('input[name="send-to-address"]').val(aZ.toString());var a1=parseFloat(a0.getQueryParamValue("amount"));if(a1>0&&!isNaN(a1)){aX.find(".send-value").val(a1)}}catch(a2){console.log(a2);h.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){h.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aO(){J();U=setTimeout(h.logout,h.getLogoutTime());for(var aZ in Z){Z[aZ]("did_decrypt")}MyStore.get("multiaddr",function(a1){if(a1!=null){H($.parseJSON(a1),true);c()}});h.get_history();$("#initial_error,#initial_success").remove();var a0=decodeURIComponent(window.location.hash.replace("#",""));if(a0.indexOf("bitcoin:")==0){var aX=$("#send-coins");af(aX);var aY=aX.find(".tab-pane.active").find(".recipient").first();h.handleURI(a0,aY)}else{af($("#home-intro"))}window.location.hash=""}function J(a0,aX){for(var aY in I){var a1=I[aY];if(a1.tag==1){alert("Warning! wallet data may have changed but cannot sync as you have un-saved keys");return}}console.log("Get wallet with checksum "+aB);var aZ={method:"wallet.aes.json",format:"json"};if(aB&&aB.length>0){aZ.checksum=aB}h.securePost("wallet",aZ,function(a2){if(!a2.payload||a2.payload=="Not modified"){if(a0){a0()}return}console.log("Wallet data modified");h.setEncryptedWalletData(a2.payload);ab(function(){h.get_history();c();if(a0){a0()}},function(){if(aX){aX()}})},function(a2){if(aX){aX()}})}function ab(aY,aX){if(aj==null||aj.length==0){aX("No Wallet Data To Decrypt");return}h.decryptWallet(aj,aK,function(a3,a1){try{d=a3.sharedKey;if(!d||d.length==0||d.length!=36){throw"Shared Key is invalid"}if(a1){Q=a1.version;P=a1.pbkdf2_iterations}if(a3.double_encryption&&a3.dpasswordhash){F=a3.double_encryption;w=a3.dpasswordhash}if(a3.options){$.extend(s,a3.options)}I={};for(var a0=0;a0<a3.keys.length;++a0){var aZ=a3.keys[a0];if(aZ.addr==null||aZ.addr.length==0||aZ.addr=="undefined"){h.makeNotice("error","null-error","Your wallet contains an undefined address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(aZ.tag==1){aZ.tag=null}I[aZ.addr]=aZ}g={};if(a3.address_book){for(var a0=0;a0<a3.address_book.length;++a0){h.addAddressBookEntry(a3.address_book[a0].addr,a3.address_book[a0].label)}}if(a3.tx_notes){b=a3.tx_notes}if(aB==null||aB.length==0){aB=ah()}e();aY()}catch(a2){aX(a2)}},aX)}this.getPassword=function(a2,a3,a0){if(!a2.is(":visible")){a2.trigger("hidden");a2.unbind()}a2.modal({keyboard:false,backdrop:"static",show:true});a2.center();var a1=a2.find('input[name="password"]');var a5=a1,aX=false,a4=false;a2.find(".vkeyboard li").unbind().click(function(){var a8=$(this),a7=a8.html();if(a8.hasClass("left-shift")||a8.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();aX=(aX===true)?false:true;a4=false;return false}if(a8.hasClass("capslock")){$(".letter").toggleClass("uppercase");a4=true;return false}if(a8.hasClass("delete")){var a6=a5.val();a5.val(a6.substr(0,a6.length-1));return false}if(a8.hasClass("symbol")){a7=$("span:visible",a8).html()}if(a8.hasClass("space")){a7=" "}if(a8.hasClass("tab")){a7="\t"}if(a8.hasClass("return")){a7="\n"}if(a8.hasClass("uppercase")){a7=a7.toUpperCase()}if(aX===true){$(".symbol span").toggle();if(a4===false){$(".letter").toggleClass("uppercase")}aX=false}a5.val(a5.val()+a7)});a1.keypress(function(a6){if(a6.keyCode==13){a6.preventDefault();a2.find(".btn.btn-primary").click()}});a1.val("");var aY=a2.find(".btn.btn-primary");aY.click(function(){if(a3){a0=null;var a6=a3;a3=null;setTimeout(function(){a2.modal("hide");a6(a1.val())},10)}else{a2.modal("hide")}});var aZ=a2.find(".btn.btn-secondary");aZ.click(function(){if(a0){var a6=a0;a0=null;a3=null;setTimeout(function(){a2.modal("hide");try{a6()}catch(a7){h.makeNotice("error","misc-error",a7)}},10)}else{a2.modal("hide")}});a2.on("hidden",function(){a1.unbind();aZ.unbind();aY.unbind();a2.unbind();if(a0){var a6=a0;a0=null;a3=null;setTimeout(function(){try{a6()}catch(a7){h.makeNotice("error","misc-error",a7)}},10)}})};this.makePairingQRCode=function(aY,aX){h.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(aX==1){h.securePost("wallet",{method:"pairing-encryption-password"},function(a0){aY($("<div></div>").qrcode({width:300,height:300,text:"1|"+M+"|"+h.encrypt(d+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aK)),a0,h.getDefaultPbkdf2Iterations())}))},function(a0){h.makeNotice("error","misc-error",a0)})}else{if(aX==0){aY($("<div></div>").qrcode({width:300,height:300,text:M+"|"+d+"|"+aK}))}}}catch(aZ){h.makeNotice("error","misc-error",aZ)}})},function(){h.logout()})};this.getMainPassword=function(aY,aX){if(B>new Date().getTime()-N){return aY(aK)}h.getPassword($("#main-password-modal"),function(aZ){if(aK==aZ){B=new Date().getTime();if(aY){try{aY(aK)}catch(a0){h.makeNotice("error","misc-error",a0)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aX){try{aX()}catch(a0){h.makeNotice("error","misc-error",a0)}}}},aX)};this.getSecondPassword=function(aZ,aX){if(!F||al!=null){if(aZ){try{aZ(al)}catch(aY){h.makeNotice("error","misc-error",aY)}}return}h.getPassword($("#second-password-modal"),function(a0){try{if(aL(a0)){if(aZ){try{aZ(a0)}catch(a1){console.log(a1);h.makeNotice("error","misc-error",a1)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aX){try{aX()}catch(a1){h.makeNotice("error","misc-error",a1)}}}}catch(a1){if(aX){try{aX()}catch(a1){h.makeNotice("error","misc-error",a1)}}}},aX)};function a(){if(A||ax){return}try{ax=true;var aX=$("#restore-password");aK=aX.val();aX.val("");B=new Date().getTime();function aY(a1){ax=false;h.makeNotice("error","misc-error",a1)}if(aj==null||aj.length==0){h.setLoadingText("Validating Authentication key");var aZ=$.trim($(".auth-"+q).find(".code").val());if(aZ.length==0||aZ.length>255){throw"You must enter a Two Factor Authentication code"}$.ajax({type:"POST",url:root+"wallet",data:{guid:M,payload:aZ,length:aZ.length,method:"get-wallet",format:"plain"},success:function(a1){try{if(a1==null||a1.length==0){throw"Server Return Empty Wallet Data"}if(a1!="Not modified"){h.setEncryptedWalletData(a1)}$(".auth-"+q).hide();$(".auth-0").show();ab(function(){ax=false;n();aO()},aY)}catch(a2){aY(a2)}},error:function(a1){aY(a1.responseText)}})}else{ab(function(){ax=false;n();aO()},aY)}}catch(a0){aY(a0)}}function O(){$("#not-synced-warning-modal").modal("show").find(".btn.btn-danger").unbind().click(function(){$(this).modal("hide");ar=true;c()})}function e(){av("error");webSocketConnect(y);A=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.quickSendNoUI=function(aZ,aY,aX){loadScript("wallet/signer",function(){h.getSecondPassword(function(){try{var a1=initNewTx();a1.from_addresses=h.getActiveAddresses();a1.to_addresses.push({address:new Bitcoin.Address(aZ),value:Bitcoin.Util.parseValue(aY)});a1.addListener(aX);a1.start()}catch(a0){aX.on_error(a0)}},function(a0){aX.on_error(a0)})})};function G(){h.setLoadingText("Sending email backup");h.securePost("wallet",{method:"email-backup"},function(aX){h.makeNotice("success","backup-success",aX)},function(aX){h.makeNotice("error","misc-error",aX.responseText)})}function ai(a0,aZ,aY,aX){if(an){clearInterval(an);an=null}an=setTimeout(function(){h.backupWallet(a0,aZ,aY,aX)},3000)}this.backupWallet=function(a3,a2,aY){if(an){clearInterval(an);an=null}var aX=function(a4){h.makeNotice("error","misc-error","Error Saving Wallet: "+a4,10000);c();if(aY!=null){aY(a4)}else{throw a4}};try{if(a3==null){a3="update"}if(aG(I)==0){return}var aZ=h.makeWalletJSON();var a1=h.encryptWallet(aZ,aK);if(a1.length==0){throw"Error encrypting the JSON output"}h.decryptWallet(a1,aK,function(a6){try{var a4=aB;h.setLoadingText("Saving wallet");h.setEncryptedWalletData(a1);h.securePost("wallet",{length:a1.length,payload:a1,checksum:aB,old_checksum:a4,method:a3,format:"plain"},function(a8){for(var a7 in I){var a9=I[a7];if(a9.tag==1){delete a9.tag}}h.makeNotice("success","misc-success",a8);c();if(a2!=null){a2()}},function(a8){for(var a7 in I){var a9=I[a7];if(a9.tag==1){O();break}}aX(a8.responseText)})}catch(a5){aX(a5)}})}catch(a0){aX(a0)}};function aP(aX){if(F){if(al==null){throw"Cannot encrypt private key without a password"}return h.encrypt(aX,d+al,h.getSecondPasswordPbkdf2Iterations())}else{return aX}return null}this.isBase58=function(aZ,aY){for(var aX=0;aX<aZ.length;++aX){if(aZ[aX]<0||aZ[aX]>58){return false}}return true};this.encrypt=function(aZ,aY,aX){return Crypto.AES.encrypt(aZ,aY,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aX})};this.encryptWallet=function(aY,aX){if(Q==2){return JSON.stringify({pbkdf2_iterations:h.getMainPasswordPbkdf2Iterations(),version:Q,payload:h.encrypt(aY,aX,h.getMainPasswordPbkdf2Iterations())})}else{if(Q==0){return h.encrypt(aY,aX,h.getDefaultPbkdf2Iterations())}else{throw"Unknown encryption version "+Q}}};this.decryptWallet=function(aY,a4,a5,a1){try{var aX=null;try{var aX=$.parseJSON(aY)}catch(aZ){console.log(aZ)}var a0=function(){try{var a7=Crypto.AES.decrypt(aX.payload,a4,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aX.pbkdf2_iterations});var a6=$.parseJSON(a7);a5(a6,aX)}catch(a8){a1("Error Decrypting Wallet. Please check your password is correct.")}};if(aX&&aX.payload&&aX.pbkdf2_iterations){if(aX.version!=ap){throw"Wallet version "+aX.version+" not supported"}if(aX.pbkdf2_iterations>100){var a3=$("#decrypting-progress-modal");var a2=setTimeout(function(){a3.modal({keyboard:false,backdrop:"static",show:true});a3.center()},500);h.decryptWebWorker(aX.payload,a4,aX.pbkdf2_iterations,function(a7){clearTimeout(a2);a3.modal("hide");try{var a6=$.parseJSON(a7);a5(a6,aX)}catch(a8){a0()}},function(){clearTimeout(a2);a3.modal("hide");a0()})}else{a0()}}else{h.decrypt(aY,a4,h.getDefaultPbkdf2Iterations(),function(a7){try{var a6=$.parseJSON(a7);try{a5(a6)}catch(a8){console.log(a8)}return true}catch(a8){return false}},function(){a1("Error Decrypting Wallet. Please check your password is correct.")})}}catch(aZ){if(a1){a1(aZ)}}};this.decryptWebWorker=function(a0,a4,aZ,a5,a3){var aX=false;var a2=function(a6){if(!aX){a3(a6);aX=true}};try{var aY=new Worker(resource+"wallet/signer"+(min?".min.js":".js"));aY.addEventListener("message",function(a7){var a6=a7.data;try{switch(a6.cmd){case"on_decrypt":a5(a6.data);aY.terminate();break;case"on_error":throw a6.e}}catch(a7){aY.terminate();a2(a7)}},false);aY.addEventListener("error",function(a6){a2(a6)});aY.postMessage({cmd:"load_resource",path:resource+"wallet/bitcoinjs"+(min?".min.js":".js")});aY.postMessage({cmd:"decrypt",data:a0,password:a4,pbkdf2_iterations:aZ})}catch(a1){a2(a1)}};this.decrypt=function(a1,a0,aY,a3,aZ){try{var aX=Crypto.AES.decrypt(a1,a0,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aY});if(aX!=null&&aX.length>0){if(a3(aX)){return aX}}}catch(a2){console.log(a2)}if(aY!=10){try{var aX=Crypto.AES.decrypt(a1,a0,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(aX!=null&&aX.length>0){if(a3(aX)){return aX}}}catch(a2){console.log(a2)}}try{var aX=Crypto.AES.decrypt(a1,a0);if(aX!=null&&aX.length>0){if(a3(aX)){return aX}}}catch(a2){console.log(a2)}try{var aX=Crypto.AES.decrypt(a1,a0,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(aX!=null&&aX.length>0){if(a3(aX)){return aX}}}catch(a2){console.log(a2)}try{var aX=Crypto.AES.decrypt(a1,a0,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(aX!=null&&aX.length>0){if(a3(aX)){return aX}}}catch(a2){console.log(a2)}if(aZ){aZ()}return null};this.handleNTPResponse=function(a1,a2){var aZ=(new Date()).getTime();if(a1.clientTimeDiff&&a1.serverTime){var aX=aZ-a1.serverTime;var aY=(a1.clientTimeDiff-aZ+a2-aX)/2;var a0=(aX-aY)/2;if(Y){aN=(aN+a0)/2}else{aN=a0;Y=true;MyStore.put("server_time_offset",""+aN)}console.log("Server Time offset "+aN+"ms - This offset "+a0)}};this.setGUID=function(aZ,aX){console.log("Set GUID "+aZ);if(A){throw"Cannot Set GUID Once Initialized"}h.setLoadingText("Changing Wallet Identifier");$("#initial_error,#initial_success").remove();var aY=$("#restore-wallet-continue");aY.prop("disabled",true);var a1=(new Date()).getTime();var a0={format:"json",resend_code:aX,ct:a1};if(aB){a0.checksum=aB}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+aZ,data:a0,timeout:10000,success:function(a2){h.handleNTPResponse(a2,a1);aY.prop("disabled",false);if(!a2.guid){h.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+q).hide();aa=a2.extra_seed;M=a2.guid;q=a2.auth_type;aQ=a2.real_auth_type;if(a2.payload&&a2.payload.length>0&&a2.payload!="Not modified"){h.setEncryptedWalletData(a2.payload)}war_checksum=a2.war_checksum;setLocalSymbol(a2.symbol_local);$("#restore-guid").val(M);$(".auth-"+q).show();if(a2.initial_error){h.makeNotice("error","misc-error",a2.initial_error)}if(a2.initial_success){h.makeNotice("success","misc-success",a2.initial_success)}MyStore.get("guid",function(a3){if(a3!=M){MyStore.remove("guid");MyStore.remove("payload");MyStore.remove("multiaddr");if(M!=D){MyStore.put("guid",M)}}});if(a2.language&&X!=a2.language){h.setLanguage(a2.language)}},error:function(a2){console.log("Set GUID Success");aY.prop("disabled",false);MyStore.get("guid",function(a3){if(a3==aZ&&aj){h.makeNotice("error","misc-error","Error Contacting Server. Using Local Wallet Cache.");M=a3;aB=ah();q=0;$("#restore-guid").val(M);$(".auth-"+q).show();return}try{var a5=$.parseJSON(a2.responseText);if(a5.initial_error){h.makeNotice("error","misc-error",a5.initial_error);return}}catch(a4){}if(a2.responseText){h.makeNotice("error","misc-error",a2.responseText)}else{h.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function i(aX){var aY=B58.encode(aX);return aP(aY)}this.decryptPK=function(aX){if(F){if(al==null){throw"Cannot decrypt private key without a password"}return h.decrypt(aX,d+al,h.getSecondPasswordPbkdf2Iterations(),h.isBase58)}else{return aX}return null};this.decodePK=function(aY){if(!aY){throw"null PK passed to decodePK"}var aX=h.decryptPK(aY);if(aX!=null){return B58.decode(aX)}return null};this.signmessage=function(aX,aZ){var a1=I[aX];if(!a1.priv){throw"Cannot sign a watch only address"}var a0=h.decodePK(a1.priv);var aY=new Bitcoin.ECKey(a0);return Bitcoin.Message.signMessage(aY,aZ,a1.addr)};function aL(aY){var aX=Crypto.SHA256(d+aY,{asBytes:true});var a1=ae(aX,h.getSecondPasswordPbkdf2Iterations()-1);if(a1==w){al=aY;return true}if(h.getSecondPasswordPbkdf2Iterations()!=10){var aZ=ae(aX,10-1);if(aZ==w){al=aY;w=a1;return true}}if(Crypto.util.bytesToHex(aX)==w){al=aY;w=a1;return true}var a0=Crypto.SHA256(aY);if(a0==w){al=aY;w=a1;return true}return false}this.runCompressedCheck=function(){var aX=[];var aZ={};for(var a0 in I){var a4=I[a0];if(a4.priv!=null){var a3=h.decodePK(a4.priv);var a1=new Bitcoin.ECKey(a3);var aY=a1.getBitcoinAddress().toString();var a2=a1.getBitcoinAddressCompressed().toString();if(a4.addr!=aY){aZ[aY]=a4.priv;aX.push(aY)}if(a4.addr!=a2){aZ[a2]=a4.priv;aX.push(a2)}}}if(aX.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(aX,function(a8){var a9=0;for(var a7 in a8){var ba=a8[a7].final_balance;if(ba>0){var a6=new Bitcoin.ECKey(h.decodePK(aZ[a7]));var a5=a6.getBitcoinAddress().toString();if(h.addPrivateKey(a6,{compressed:a5!=a7,app_name:IMPORTED_APP_NAME,app_version:IMPORTED_APP_VERSION})){alert(formatBTC(ba)+" claimable in address "+a7)}}a9+=ba}alert(formatBTC(a9)+" found in compressed addresses");if(a9>0){h.backupWallet("update",function(){h.get_history()})}})};this.checkAllKeys=function(aX){for(var aY in I){var a2=I[aY];if(a2.addr==null){throw"Null Address Found in wallet "+aY}if(a2.addr.toString()==null){throw"Error decoding wallet address "+a2.addr}if(a2.priv!=null){var a1=h.decodePK(a2.priv);var a0=new Bitcoin.ECKey(a1);var aZ=a0.getBitcoinAddress().toString();if(aZ!=a2.addr&&a0.getBitcoinAddressCompressed().toString()!=a2.addr){throw"Private key does not match bitcoin address "+a2.addr+" != "+aZ}if(aX){a2.priv=i(a1)}}}h.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(aX){h.getMainPassword(function(){aK=aX;h.backupWallet("update",function(){h.logout()},function(){h.logout()})})};function af(aX){if(aX===j){return}if(j!=null){if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","")}j.hide()}j=aX;j.show();if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","active")}c(true)}function aG(aZ){var aY=0,aX;for(aX in aZ){aY++}return aY}function ad(aX){I[aX].priv=null}function ak(){if(aG(I)>=aD){h.makeNotice("error","misc-error","We currently support a maximum of "+aD+" private keys, please remove some unused ones.");return true}return false}function aT(aZ,aX){var aY=I[aZ];if(!aY||aY.length==0){I[aZ]={addr:aZ,priv:aX,balance:0};return true}else{if(!aY.priv&&aX){aY.priv=aX;return true}}return false}function o(){var aZ=$("#add-address-book-entry-modal");aZ.modal({keyboard:true,backdrop:"static",show:true});var aX=aZ.find('input[name="label"]');var aY=aZ.find('input[name="address"]');aX.val("");aY.val("");aZ.find(".btn.btn-primary").unbind().click(function(){aZ.modal("hide");var a1=stripHTML(aX.val());var a0=stripHTML(aY.val());if(a1.length==0||a0.length==0){h.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}var a3;try{a3=new Bitcoin.Address(a0);if(a3==null){throw"Null address"}}catch(a2){h.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(g[a0]!=null){h.makeNotice("error","misc-error","Bitcoin address already exists");return false}h.makeNotice("success","misc-success","Added Address book entry");h.addAddressBookEntry(a0,a1);ai();$("#send-coins").find(".tab-pane").trigger("show",true)});aZ.find(".btn.btn-secondary").unbind().click(function(){aZ.modal("hide")})}this.logout=function(){if(aq){return}if(M==D){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",url:root+"wallet/logout",data:{format:"plain"},success:function(aX){window.location.reload()},error:function(){window.location.reload()}})}};function ao(a3){var a5=$("#delete-address-modal");a5.modal({keyboard:true,backdrop:"static",show:true});a5.find(".btn.btn-primary").hide();a5.find(".btn.btn-danger").hide();$("#change-mind").hide();a5.find("#to-delete-address").html(a3.join(" "));a5.find("#delete-balance").empty();var aZ=a5.find("#delete-balance");var aX=[];for(var a2 in a3){var a4=a3[a2];if(I[a4]&&I[a4].priv){aX.push(a3[a2])}}BlockchainAPI.get_balance(aX,function(a6){a5.find(".btn.btn-primary").show(200);a5.find(".btn.btn-danger").show(200);aZ.html("Balance "+formatBTC(a6));if(a6>0){aZ.css("color","red")}else{aZ.css("color","black")}},function(){a5.find(".btn.btn-primary").show(200);a5.find(".btn.btn-danger").show(200);aZ.text("Error Fetching Balance")});var a0=false;var a2=0;var aY=null;var a1=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(a1-a2)};a5.find(".btn.btn-primary").unbind().click(function(){changeMind();a5.find(".btn.btn-primary").hide();a5.find(".btn.btn-danger").hide();aY=setInterval(function(){if(a0){return}++a2;changeMind();if(a2==a1){$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var a6 in a3){ad(a3[a6])}c();h.backupWallet();clearInterval(aY)}},1000)});a5.find(".btn.btn-danger").unbind().click(function(){changeMind();a5.find(".btn.btn-primary").hide();a5.find(".btn.btn-danger").hide();aY=setInterval(function(){if(a0){return}++a2;changeMind();if(a2==a1){try{$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var a6 in a3){h.deleteAddress(a3[a6])}c();h.backupWallet("update",function(){h.get_history()})}finally{clearInterval(aY)}}},1000)});a5.unbind().on("hidden",function(){if(aY){a0=true;clearInterval(aY);aY=null}});a5.find(".btn.btn-secondary").unbind().click(function(){a5.modal("hide")})}function aC(){var aZ=[];for(var aX in g){aZ.push(g[aX])}for(var aX in I){var aY=I[aX];if(aY.tag!=2&&aY.label){aZ.push(aY.label)}}return aZ}this.sweepAddressesModal=function(aY,aX){h.getSecondPassword(function(){var a0=$("#sweep-address-modal");a0.modal("show");BlockchainAPI.get_balance(aY,function(a1){a0.find(".balance").text("Amount: "+formatBTC(a1))},function(){a0.find(".balance").text("Error Fetching Balance")});var aZ=a0.find('select[name="change"]');l(aZ,true);a0.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(aY,function(a2){var a3=initNewTx();var a1=aZ.val();if(a1=="any"){a1=h.getPreferredAddress()}a3.fee=a3.base_fee;a3.to_addresses.push({address:new Bitcoin.Address(a1),value:BigInteger.valueOf(a2).subtract(a3.fee)});a3.from_addresses=aY;a3.extra_private_keys=aX;a3.start()},function(){h.makeNotice("error","misc-error","Error Getting Address Balance")})});a0.modal("hide")});a0.find(".btn.btn-secondary").unbind().click(function(){a0.modal("hide")})})};this.openWindow=function(aY){function aX(a0){var aZ=false;try{if(typeof a0=="undefined"||!a0){aZ=true}else{if(a0&&a0.closed){aZ=false}else{if(a0&&a0.test){aZ=false}}}}catch(a1){}return aZ}window.open(aY,null,"scroll=1,status=1,location=1,toolbar=1");if(aX(window)){h.makeNotice("error","misc-error","Popup Blocked. Try and click again.");return false}else{return true}};function aE(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(aX){}}function n(){if(T){return}T=true;$("#add-address-book-entry-btn").click(function(){o()});$("#home-intro-btn").click(function(){af($("#home-intro"))});$("#my-transactions-btn").click(function(){af($("#my-transactions"))});$("#send-coins-btn").click(function(){af($("#send-coins"))});$("#import-export-btn").click(function(){af($("#import-export"));R()});$("#chord-diagram").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Address Relationships",description:"",src:root+"taint/"+h.getActiveAddresses().join("|")})})});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(aX){h.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){af($("#my-account"));var aX=$("#account-settings-warning").show();var aY=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){h.getMainPassword(function(){aX.hide();loadScript("wallet/account",function(){AccountSettings.init(aY,function(){aY.show()},function(){af($("#home-intro"))})},function(aZ){h.makeNotice("error","misc-error",aZ);af($("#home-intro"))})},function(){af($("#home-intro"))})})});$("#enable_archived_checkbox").change(function(){var aX=$(this).is(":checked");$(".archived_checkbox").prop("checked",false);$(".archived_checkbox").prop("disabled",!aX);$("#archived-sweep").prop("disabled",!aX);$("#archived-delete").prop("disabled",!aX)});$("#shared-addresses").on("show",function(){var aX=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(aX)})});$("#active-addresses").on("show",function(){var a3=$(this).find("table:first");a3.find("tbody:gt(0)").remove();var a0=a3.find("tbody").empty();for(var a2 in I){var a4=I[a2];if(a4.tag==2||(a4.tag==1&&!ar)){continue}var a1="";if(a4.tag==1){a1=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(a4.priv==null){a1=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var aX="";var aZ=a4.addr;if(a4.label!=null){aZ=a4.label;aX='<span class="hidden-phone"> - '+a4.addr+"</span>"}var aY=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+a4.addr+'" target="new">'+aZ+"</a>"+aX+" "+a1+'<div></td><td><span style="color:green">'+formatMoney(a4.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a5){aY.find(".act-archive").click(function(){h.archiveAddr(a5)});aY.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a5)})});aY.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a5)})});aY.find(".act-pubkey").click(function(){h.getSecondPassword(function(){var a6=h.getPrivateKey(a5);if(a6==null){h.makeNotice("eror","misc-error","Public Key Unknown");return}var a7=new Bitcoin.ECKey(h.decodePK(a6));if(a7.getBitcoinAddressCompressed().toString()==a5){var a8=a7.getPubCompressed()}else{var a8=a7.getPub()}h.makeNotice("success","pub-key","Public Key of "+a5+" is "+Crypto.util.bytesToHex(a8),20000)})});aY.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a5)})});aY.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a5+"</b>",src:root+"payment_request?address="+a5})})})})(a4.addr);if(a4.balance>0&&a4.priv){a3.prepend(aY)}else{a3.append(aY)}}aE()});$("#archived-addresses").on("show",function(){$("#enable_archived_checkbox").prop("checked",false);$("#archived-delete").prop("disabled",true);$("#archived-sweep").prop("disabled",true);$("#archived-addr tbody").empty();var aY=$(this).find("tbody");var aX=h.getArchivedAddresses();var aZ=function(){aY.empty();for(var a3 in aX){var a5=I[aX[a3]];if(a5.tag!=2||(a5.tag==1&&!ar)){continue}var a2="";if(a5.priv==null){a2=' <font color="red">(Watch Only)</font>'}var a0="";var a1=a5.addr;if(a5.label!=null){a1=a5.label;a0='<span class="hidden-phone"> - '+a5.addr+"</span>"}var a4=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a5.addr+'" disabled></td><td><div class="short-addr"><a href="'+root+"address/"+a5.addr+'" target="new">'+a1+"</a>"+a0+" "+a2+'<div></td><td><span style="color:green">'+formatBTC(a5.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(a6){a4.find(".act-unarchive").click(function(){h.unArchiveAddr(a6)})})(a5.addr);if(a5.balance>0&&a5.priv){aY.prepend(a4)}else{aY.append(a4)}}};aZ();BlockchainAPI.get_balances(aX,function(a0){aZ()},function(a0){h.makeNotice("error","misc-error",a0)})});$("#archived-sweep").click(function(){var aX=[];$(".archived_checkbox:checked").each(function(){var aY=I[$(this).val()];if(aY.priv==null){h.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}aX.push(aY.addr)});if(aX.length==0){return}h.sweepAddressesModal(aX)});$("#archived-delete").click(function(){var aX=[];$(".archived_checkbox:checked").each(function(){aX.push($(this).val())});if(aX.length==0){return}ao(aX)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".deposit-btn").click(function(){var aZ=$(this);var aY=h.getPreferredAddress();var aX=aZ.data("extra");if(aX==null){aX=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:aZ.data("title"),description:"Deposit into address <b>"+aY+"</b>",top_right:'Have Questions? Read <a href="'+aZ.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+aY+"&ptype="+aZ.data("type")+"&guid="+M+aX})})});$(".withdraw-btn").click(function(){var aX=$(this);h.getSecondPassword(function(){var aY=h.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:aX.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(aA)+"</b>",src:root+"withdraw?method="+aX.data("type")+"&address="+aY+"&balance="+aA+"&guid="+M})})})});$("#logout").click(h.logout);$("#refresh").click(function(){J();h.get_history()});$("#summary-n-tx-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Number of transactions",description:"",src:root+"charts/n-transactions?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-received-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"BTC Received Per Day",description:"",src:root+"charts/received-per-day?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-balance-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Wallet Balance",description:"",src:root+"charts/balance?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#new-addr").click(function(){try{J(function(){h.getSecondPassword(function(){var aZ=h.generateNewKey();if(!aZ){return}var aY=aZ.getBitcoinAddress().toString();h.backupWallet("update",function(){h.makeNotice("info","new-address","Generated new Bitcoin Address "+aY);loadScript("wallet/address_modal",function(){showLabelAddressModal(aY)})})})})}catch(aX){h.makeNotice("error","misc-error",aX)}});$(".tx_filter a").click(function(){ay=0;at=$(this).data("value");h.get_history()});$(".tx_display a").click(function(){var aX=$(this).data("value");if(aX=="export"){v();return}s.tx_display=aX;c();ai()});$("#email-backup-btn").click(function(){G()});$("#dropbox-backup-btn").click(function(){h.openWindow(root+"wallet/dropbox-login?guid="+M)});$("#gdrive-backup-btn").click(function(){h.openWindow(root+"wallet/gdrive-login?guid="+M)});$("#large-summary").click(function(){toggleSymbol();c()});$("#send-quick").on("show",function(aZ,aY){var aX=$(this);r(aX,aY);aX.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aX,"quick",initNewTx())})})});$("#send-email").on("show",function(aZ,aY){var aX=$(this);r(aX,aY);aX.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aX,"email",initNewTx())})})});$("#send-shared").on("show",function(aZ,aY){var aX=$(this);r(aX,aY);aX.find(".mixer_fee").text(x);aX.find(".fees,.free,.bonus").show();if(x<0){aX.find(".fees,.free").hide()}else{if(x==0){aX.find(".fees,.bonus").hide()}else{aX.find(".free,.bonus").hide()}}aX.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aX,"shared",initNewTx())})});aX.find(".shared-fees").text("0.00");aX.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var a1=parseFloat($(this).val());var a0=0;if(a1>0){if(x>0){a0=parseFloat(a1+((a1/100)*x))}else{a0=parseFloat(a1);aX.find(".bonus-value").text(formatPrecision((Math.min(a1,precisionFromBTC(200))/100)*x))}}if(precisionToBTC(a1)<0.1||precisionToBTC(a1)>250){aX.find(".shared-fees").text("0.00");aX.find(".send").prop("disabled",true)}else{aX.find(".shared-fees").text(formatBTC(a0*symbol_btc.conversion));aX.find(".send").prop("disabled",false)}aX.find(".send-value").val(a0).trigger("keyup")})});$("#send-custom").on("show",function(aZ,aY){var aX=$(this);r(aX,aY);aX.find(".send").unbind().click(function(){var a0=false;if(aX.find('textarea[name="public-note"]').val()){aX.find(".send-value").each(function(){if($(this).val()<0.0001){h.makeNotice("error","misc-error","You cannot attach a note to a transaction with an output size less than 0.0001 BTC");a0=true;return false}})}if(!a0){loadScript("wallet/signer",function(){startTxUI(aX,"custom",initNewTx())})}});aX.find('input[name="fees"]').unbind().bind("keyup change",function(a0){if(a0.keyCode=="9"){return}$(this).parent().find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});aX.find(".reset").unbind().click(function(){r(aX,true);aX.find('select[name="from"]').trigger("change")})});$("#send-satoshi-dice").on("show",function(aZ,aY){var aX=this;loadScript("wallet/dicegames",function(){try{DICEGame.init($(aX))}catch(a0){h.makeNotice("error","misc-error","Unable To Load Dice Bets")}},function(a0){h.makeNotice("error","misc-error",a0)})});$("#shared-coin").on("show",function(aZ,aY){var aX=$(this);loadScript("wallet/sharedcoin",function(){try{r(aX);SharedCoin.init(aX)}catch(a0){console.log(a0);h.makeNotice("error","misc-error",a0)}},function(a0){h.makeNotice("error","misc-error",a0)})});$("#send-sms").on("show",function(aZ,aY){if(aY){return}var aX=$(this);r(aX);$.ajax({type:"GET",url:resource+"wallet/country_codes.html",success:function(a0){aX.find('select[name="sms-country-code"]').html(a0)},error:function(){h.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});aX.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var a0=initNewTx();startTxUI(aX,"sms",a0)})})});$("#address-book").on("show",function(){var aY=$("#address-book-tbl tbody");if(aG(g)>0){aY.empty();for(var aX in g){var aZ=$("<tr><td>"+g[aX]+'</td><td><div class="addr-book-entry">'+aX+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(a0){aZ.find(".act-delete").click(function(){h.deleteAddressBook(a0)})})(aX);aY.append(aZ)}}});$('a[data-toggle="tab"]').unbind().on("show",function(aX){$(aX.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){af($("#receive-coins"))});$("#cash-into-coins").click(function(){$(this).attr("href",$(this).attr("href")+h.getPreferredAddress())});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aE()}function p(){$(".resend-code").click(function(){h.setGUID(M,true)});$("#reset-two-factor-btn").click(function(){h.openWindow(root+"wallet/reset-two-factor"+(M?"?guid="+M:""))});$(".recover-wallet-btn").click(function(){h.openWindow(root+"wallet/forgot-password"+(M?"?guid="+M:""))});$(".download-backup-btn").toggle(aj!=null).click(function(){if(!aj){h.makeNotice("error","error","No Wallet Data to Download");return}try{var aY=!!new Blob()}catch(aZ){}if(aY){loadScript("wallet/filesaver",function(){var a0=new Blob([aj],{type:"text/plain;charset=utf-8"});saveAs(a0,"wallet.aes.json")})}else{var aX=window.open(null,null,"width=700,height=800,toolbar=0");aX.document.write('<!DOCTYPE html><html><head></head><body><div style="word-wrap:break-word;" >'+aj+"</div></body></html>")}aU()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(aX){if(aX.keyCode==13){aX.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(aY){aY.preventDefault();var aX=$.trim($("#restore-guid").val());if(aX.length==0){return}if(M!=aX){h.setGUID(aX,false)}else{a()}});$(".modal").on("show",function(){L();$(this).center()}).on("hidden",function(){var aY=$(".modal:visible");var aX=$("#notices").remove();if(aY.length>0){aY.find(".modal-body").prepend(aX)}else{$("#main-notices-container").append(aX)}}).on("shown",function(){L();var aX=$(this);setTimeout(function(){if(aX.is(":visible")){aX.find(".modal-body").prepend($("#notices").remove())}},100);aX.center()})}function am(aY){var aZ=Crypto.SHA256(aY+"?");switch(aZ.slice(0,2)){case"00":var a0=Crypto.SHA256(aY,{asBytes:true});return a0;break;case"01":var aX=Crypto.util.hexToBytes(aZ.slice(2,4))[0];var a1=Math.round(Math.pow(2,(aX/4)));var a0=Crypto.PBKDF2(aY,"Satoshi Nakamoto",32,{iterations:a1,asBytes:true});return a0;break;default:console.log("invalid key");break}}function aJ(){var aZ,aX="";if(window.getSelection){aZ=window.getSelection();if(aZ.rangeCount){var a0=aZ.getRangeAt(0).cloneContents();var aY=document.createElement("div");aY.appendChild(a0);aX=aY.innerText}}else{if(document.selection&&document.selection.type=="Text"){aX=document.selection.createRange().htmlText}}return aX}this.detectPrivateKeyFormat=function(aY){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(aY)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(aY)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(aY)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(aY)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(aY)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(aY)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(aY)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(aY)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(aY)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(aY)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(aY)){var aX=Crypto.SHA256(aY+"?",{asBytes:true});if(aX[0]===0||aX[0]===1){return"mini"}}throw"Unknown Key Format "+aY};this.privateKeyStringToKey=function(aY,a0){var aX=null;if(a0=="base58"){aX=B58.decode(aY)}else{if(a0=="base64"){aX=Crypto.util.base64ToBytes(aY)}else{if(a0=="hex"){aX=Crypto.util.hexToBytes(aY)}else{if(a0=="mini"){aX=am(aY)}else{if(a0=="sipa"){var aZ=B58.decode(aY);aZ.shift();aX=aZ.slice(0,aZ.length-4)}else{if(a0=="compsipa"){var aZ=B58.decode(aY);aZ.shift();aZ.pop();aX=aZ.slice(0,aZ.length-4)}else{throw"Unsupported Key Format"}}}}}}if(aX.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(aX)};$(document).ready(function(){if(!$.isEmptyObject({})){h.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");var a1=$(document.body);function a2(){if(M&&M.length==36){setTimeout(function(){h.setGUID(M,false)},10)}else{$("#signup-btn").show()}}M=a1.data("guid");d=a1.data("sharedkey");X=a1.data("language");if(h.skip_init){return}var a3=1;function a0(){--a3;if(a3==-1){p()}}MyStore.get("payload",function(a6){if(!aj&&a6){aj=a6;aB=ah()}a0()});MyStore.get("server_time_offset",function(a6){aN=parseInt(a6);if(isNaN(aN)){aN=0}});if((!M||M.length==0)&&(isExtension||window.location.href.indexOf("/login")>0)){++a3;MyStore.get("guid",function(a6){M=a6;a2();a0()})}else{a2()}if(top.location!=self.location){top.location=self.location.href}a1.click(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).keypress(function(){if(U){clearTimeout(U);U=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).mousemove(function(a6){if(a6){rng_seed_int(a6.clientX*a6.clientY)}});a0();$(".auth-"+q).show();j=$("#restore-wallet");j.show();var a5=false;var aY=17,aZ=86,aX=67,a4=67;$(document).keydown(function(a7){try{if(a7.keyCode==aY||a7.keyCode==a4){a5=true}if(a5&&a7.keyCode==aX){var a6=$.trim(aJ());var a8=I[a6];if(a8!=null){if(a8.priv==null){$("#watch-only-copy-warning-modal").modal("show")}else{if(a8.tag==1){O()}}}}}catch(a7){console.log(a7)}}).keyup(function(a6){if(a6.keyCode==aY||a6.keyCode==a4){a5=false}}).ajaxStart(function(){av("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){av("loading_stop");$(".loading-indicator").hide()})});function aW(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};