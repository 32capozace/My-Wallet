function precisionToSatoshiBN(a){return Bitcoin.Util.parseValue(a).divide(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)).toString()))}function precisionToBTC(a){return Bitcoin.Util.formatValue(precisionToSatoshiBN(a))}function precisionFromSatoshi(a){return Bitcoin.Util.formatValue(a.multiply(BigInteger.valueOf(Math.pow(10,sShift(symbol_btc)))))}function precisionFromBTC(a){return precisionFromSatoshi(Bitcoin.Util.parseValue(a))}function formatPrecision(a){return formatBTC(precisionToSatoshiBN(a).toString())}var MyWallet=new function(){var h=this;this.skip_init=false;var E="abcaa314-6f67-6705-b384-5d47fbe9d7cc";var al;var O;var j;var aM;var an;var w;var d;var aC=0;var U=0;var aw=0;var M=0;var aX=0;var aK;var g={};var F=[];var G=false;var aA=0;var av=0;var aF=1000;var K={};var aD;var ap;var x=0.5;var I=true;var aj=10;var R=aj;var b={};var q;var aS=0;var W;var ab=[];var C;var P=60000;var B=false;var ac;var au=false;var Z="en";var ar=2;var S=0;var aP=0;var aa=false;var aH;var at=false;var V=false;var az=false;var z=false;var s={pbkdf2_iterations:aj,fee_policy:0,html5_notifications:false,logout_time:600000,tx_display:0,always_keep_local_backup:false,transactions_per_page:30,additional_seeds:[]};this.setEncryptedWalletData=function(aZ){if(!aZ||aZ.length==0){al=null;aD=null;return}al=aZ;aD=ak();try{if(aS==0||s.always_keep_local_backup){MyStore.put("payload",al)}else{MyStore.remove("payload")}}catch(a0){console.log(a0)}};this.setRealAuthType=function(aZ){aS=aZ};this.addAdditionalSeeds=function(aZ){s.additional_seeds.push(aZ)};this.getAdditionalSeeds=function(aZ){return s.additional_seeds};this.getLanguage=function(){return Z};this.setLanguage=function(aZ){MyStore.put("language",aZ);Z=aZ};this.addEventListener=function(aZ){ab.push(aZ)};this.getLogoutTime=function(){return s.logout_time};this.getSecondPasswordPbkdf2Iterations=function(){return s.pbkdf2_iterations};this.getMainPasswordPbkdf2Iterations=function(){return R};this.getDefaultPbkdf2Iterations=function(){return aj};this.getSharedcoinEndpoint=function(){return aH};this.disableLogout=function(aZ){at=aZ};this.setLogoutTime=function(aZ){s.logout_time=aZ;clearInterval(W);W=setTimeout(h.logout,h.getLogoutTime())};this.getDoubleEncryption=function(){return G};this.getEncryptedWalletData=function(){return al};this.getFeePolicy=function(){return s.fee_policy};this.setFeePolicy=function(aZ){s.fee_policy=parseInt(aZ)};this.setAlwaysKeepLocalBackup=function(aZ){s.always_keep_local_backup=aZ};this.getAlwaysKeepLocalBackup=function(){return s.always_keep_local_backup};this.setNTransactionsPerPage=function(aZ){s.transactions_per_page=aZ};this.getNTransactionsPerPage=function(){return s.transactions_per_page};this.getGuid=function(){return O};this.getHTML5Notifications=function(){return s.html5_notifications};this.setHTML5Notifications=function(aZ){s.html5_notifications=aZ};this.getTransactions=function(){return F};this.addressExists=function(aZ){return K[aZ]!=null};this.getAddressTag=function(aZ){return K[aZ].tag};this.setAddressTag=function(a0,aZ){K[a0].tag=aZ};this.getAddressBook=function(){return g};this.getAddressLabel=function(aZ){return K[aZ].label};this.setAddressLabel=function(aZ,a0){K[aZ].label=a0};this.setAddressBalance=function(aZ,a0){K[aZ].balance=a0};this.getAddressBookLabel=function(aZ){return g[aZ]};this.isWatchOnly=function(aZ){return !K[aZ]||K[aZ].priv==null};this.getAddressBalance=function(aZ){return K[aZ].balance};this.getMixerFee=function(){return x};this.getRecommendIncludeFee=function(){return I};this.deleteAddress=function(aZ){delete K[aZ]};this.addAddressBookEntry=function(a0,aZ){g[a0]=aZ};this.getPrivateKey=function(aZ){return K[aZ].priv};this.setLabel=function(aZ,a0){K[aZ].label=a0;h.backupWalletDelayed();c()};this.securePost=function(aZ,a2,a9,a6){var a5=jQuery.extend({},a2);if(!a2.sharedKey){if(!d||d.length==0||d.length!=36){throw"Shared key is invalid"}var a0=new Date().getTime();var a4=parseInt((a0-aP)/10000);var a3=Crypto.SHA256(d.toLowerCase()+a4);var a1=0;var a8=a3.substring(a1,a1+=8)+"-"+a3.substring(a1,a1+=4)+"-"+a3.substring(a1,a1+=4)+"-"+a3.substring(a1,a1+=4)+"-"+a3.substring(a1,a1+=12);a5.sharedKey=a8;a5.sKTimestamp=a4;a5.sKDebugHexHash=a3;a5.sKDebugTimeOffset=aP;a5.sKDebugOriginalClientTime=a0;a5.sKDebugOriginalSharedKey=d}if(!a2.guid){a5.guid=O}a5.format=a2.format?a2.format:"plain";var a7="text";if(a2.format=="json"){a7="json"}$.ajax({dataType:a7,type:"POST",url:root+aZ,data:a5,success:a9,error:a6})};this.isCorrectMainPassword=function(aZ){return aM==aZ};function ag(a0,a2){var aZ=Crypto.SHA256(a0,{asBytes:true});for(var a1=1;a1<a2;++a1){aZ=Crypto.SHA256(aZ,{asBytes:true})}return Crypto.util.bytesToHex(aZ)}this.setPbkdf2Iterations=function(aZ,a1){var a0=function(a2){console.log("Panic "+a2);window.location.reload()};h.getSecondPassword(function(){try{if(G){for(var a2 in K){var a4=K[a2];if(a4.priv){a4.priv=h.encrypt(h.decryptPK(a4.priv),d+an,aZ);if(!a4.priv){throw"addr.priv is null"}}}s.pbkdf2_iterations=aZ;w=ag(d+an,aZ)}S=2;R=aZ;h.backupWallet("update",function(){a1()},function(){a0(a3)})}catch(a3){a0(a3)}},function(a2){a0(a2)})};this.setDoubleEncryption=function(a1,aZ,a3){var a0=function(a4){console.log("Panic "+a4);window.location.reload()};try{if(G==a1){return}if(a1){h.getSecondPassword(function(){try{G=true;an=aZ;for(var a4 in K){var a6=K[a4];if(a6.priv){a6.priv=i(B58.decode(a6.priv));if(!a6.priv){throw"addr.priv is null"}}}w=ag(d+an,s.pbkdf2_iterations);an=null;h.getSecondPassword(function(){try{h.checkAllKeys();h.backupWallet("update",function(){a3()},function(){a0(a7)})}catch(a7){a0(a7)}},function(a7){a0(a7)})}catch(a5){a0(a5)}},function(a4){a0(a4)})}else{h.getSecondPassword(function(){try{for(var a4 in K){var a6=K[a4];if(a6.priv){a6.priv=h.decryptPK(a6.priv);if(!a6.priv){throw"addr.priv is null"}}}G=false;an=null;h.checkAllKeys();h.backupWallet("update",function(){a3()},function(){a0(a5)})}catch(a5){a0(a5)}},function(a4){a0(a4)})}}catch(a2){a0(a2)}};this.unArchiveAddr=function(aZ){var aZ=K[aZ];if(aZ.tag==2){aZ.tag=null;c();h.backupWalletDelayed("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Unarchive This Address")}};this.archiveAddr=function(aZ){if(h.getActiveAddresses().length<=1){h.makeNotice("error","add-error","You must leave at least one active address");return}var aZ=K[aZ];if(aZ.tag==null||aZ.tag==0){aZ.tag=2;c();h.backupWalletDelayed("update",function(){h.get_history()})}else{h.makeNotice("error","add-error","Cannot Archive This Address")}};this.addWatchOnlyAddress=function(aZ){return aV(aZ)};this.addPrivateKey=function(aZ,a1){if(am()){return false}if(aZ==null){throw"Cannot add null key."}if(a1==null){a1={}}var a4=a1.compressed?aZ.getBitcoinAddressCompressed().toString():aZ.getBitcoinAddress().toString();var a3=i(aZ.priv);if(a3==null){throw"Error Encoding key"}var a0=new Bitcoin.ECKey(h.decodePK(a3));if(a4!=a0.getBitcoinAddress().toString()&&a4!=a0.getBitcoinAddressCompressed().toString()){throw"Decoded Key address does not match generated address"}if(aV(a4,a3)){K[a4].tag=1;K[a4].created_time=a1.created_time?a1.created_time:0;K[a4].created_device_name=a1.app_name?a1.app_name:APP_NAME;K[a4].created_device_version=a1.app_version?a1.app_version:APP_VERSION;if(K[a4].priv!=a3){throw"Address priv does not match encoded"}try{ws.send('{"op":"addr_sub", "addr":"'+a4+'"}')}catch(a2){}}else{throw"Unable to add generated bitcoin address."}return a4};this._seed=function(a1){rng_seed_time();if(aM||a1){var aZ=Crypto.util.bytesToWords(Crypto.SHA256(aM?aM:a1,{asBytes:true}));for(var a0 in aZ){rng_seed_int(aZ[a0])}}if(!ac){ac=$("body").data("extra-seed")}if(ac){var aZ=Crypto.util.bytesToWords(Crypto.util.hexToBytes(ac));for(var a0 in aZ){rng_seed_int(aZ[a0])}}};this.generateNewKey=function(a0){h._seed(a0);var aZ=new Bitcoin.ECKey(false);if(h.addPrivateKey(aZ)){return aZ}};this.setLoadingText=function(aZ){$(".loading-text").text(aZ)};function N(){try{$(".popover").remove()}catch(aZ){}}$(window).resize(function(){$(".modal:visible").center();N()});function aU(a0,aZ){a0.click(function(){A(aZ.txIndex,aZ.result)});a0.find(".show-note").unbind("mouseover").mouseover(function(){var a1=aZ.note?aZ.note:b[aZ.hash];aO(this,a1,aZ.hash)});a0.find(".add-note").unbind("mouseover").mouseover(function(){m(this,aZ.hash)});return a0}function t(a0,a6){var aZ=0;for(var a2=0;a2<a0.inputs.length;++a2){var a1=a0.inputs[a2].prev_out;if(!a1||!a1.addr){continue}var a5=K[a1.addr];if(a5){var a4=parseInt(a1.value);aZ-=a4;if(a6){U+=a4;a5.balance-=a4}}}for(var a3=0;a3<a0.out.length;++a3){var a1=a0.out[a3];if(!a1||!a1.addr){continue}var a5=K[a1.addr];if(a5){var a4=parseInt(a1.value);aZ+=a4;if(a6){aw+=a4;a5.balance+=a4}}}return aZ}function ak(){return Crypto.util.bytesToHex(Crypto.SHA256(al,{asBytes:true}))}function y(aZ){var a0=null;aZ.onmessage=function(a7){try{var a4=$.parseJSON(a7.data);if(a4.op=="on_change"){var a8=ak();var a6=a4.checksum;console.log("On change old "+a8+" ==  new "+a6);if(a0!=a6&&a8!=a6){a0=a6;L()}}else{if(a4.op=="utx"){var a5=TransactionFromJSON(a4.x);for(var ba in F){if(F[ba].txIndex==a5.txIndex){return}}var bc=t(a5,true);if(h.getHTML5Notifications()){h.showNotification({title:bc>0?"Payment Received":"Payment Sent",body:"Transaction Value "+formatBTC(bc),iconUrl:resource+"cube48.png"})}a5.result=bc;aC+=bc;M++;a5.setConfirmations(0);playSound("beep");if(av==0&&aA==0){F.unshift(a5);var a9=false;if(F.length>h.getNTransactionsPerPage()){F.pop();a9=true}}var a2=X();if("my-transactions"==a2){if(av==0&&aA==0){$("#no-transactions").hide();if(s.tx_display==0){var a1=$("#transactions-compact").show();aU($(D(a5,K,g)),a5).prependTo(a1.find("tbody")).find("div").hide().slideDown("slow");if(a9){a1.find("tbody tr:last-child").remove()}}else{var a1=$("#transactions-detailed").show();a1.prepend(a5.getHTML(K,g));if(a9){a1.find("div:last-child").remove()}setupSymbolToggle()}}}else{c()}}else{if(a4.op=="block"){for(var a3=0;a3<a4.x.txIndexes.length;++a3){for(var bb=0;bb<F.length;++bb){if(F[bb].txIndex==a4.x.txIndexes[a3]){if(F[bb].blockHeight==null||F[bb].blockHeight==0){F[bb].blockHeight=a4.x.height;break}}}}aB(BlockFromJSON(a4.x));Y()}}}}catch(a7){console.log(a7);console.log(a7.data)}};aZ.onopen=function(){ax("ok");var a4='{"op":"blocks_sub"}';if(O!=null){a4+='{"op":"wallet_sub","guid":"'+O+'"}'}try{var a2=h.getActiveAddresses();for(var a1 in a2){a4+='{"op":"addr_sub", "addr":"'+a2[a1]+'"}'}}catch(a3){alert(a3)}aZ.send(a4)};aZ.onclose=function(){ax("error")}}var aT="ok";function ax(a0){var aZ=$("#logout");if(a0=="loading_start"){aZ.attr("src",resource+"logout-orange.png");return}else{if(a0!="loading_stop"){aT=a0}}if(aT=="ok"){aZ.attr("src",resource+"logout.png")}else{if(aT=="error"){aZ.attr("src",resource+"logout-red.png")}}}this.showNotification=function(aZ,a0){try{var a2;if(window.webkitNotifications&&webkitNotifications.checkPermission()==0){a2=webkitNotifications.createNotification(aZ.iconUrl,aZ.title,aZ.body);a2.show()}else{if(window.Notification&&window.Notification.permissionLevel()=="granted"){a2=new window.Notification(aZ.title,aZ).show()}}setTimeout(function(){a2.cancel()},a0?a0:5000)}catch(a1){}};this.makeNotice=function(a0,a3,a2,a1){if(a2==null||a2.length==0){return}console.log(a2);var aZ=$('<div class="alert alert-block alert-'+a0+'"></div>');aZ.text(""+a2);if($("#"+a3).length>0){aZ.attr("id",a3);return}$("#notices").append(aZ).hide().fadeIn(200);(function(){var a4=aZ;setTimeout(function(){a4.fadeOut(250,function(){$(this).remove()})},a1?a1:5000)})()};this.pkBytesToSipa=function(aZ,a3){var a0=new Bitcoin.ECKey(aZ);while(aZ.length<32){aZ.unshift(0)}aZ.unshift(128);if(a0.getBitcoinAddress().toString()==a3){}else{if(a0.getBitcoinAddressCompressed().toString()==a3){aZ.push(1)}else{throw"Private Key does not match bitcoin address"+a3}}var a1=Crypto.SHA256(Crypto.SHA256(aZ,{asBytes:true}),{asBytes:true});aZ=aZ.concat(a1.slice(0,4));var a2=B58.encode(aZ);return a2};function aJ(aZ){return aZ}function ay(aZ){return h.decryptPK(aZ)}function ae(aZ){var a0=h.decodePK(aZ);return Crypto.util.bytesToBase64(a0)}function k(aZ){var a0=h.decodePK(aZ);return Crypto.util.bytesToHex(a0)}this.base58ToSipa=function(aZ,a0){return h.pkBytesToSipa(h.decodePK(aZ),a0)};this.makeWalletJSON=function(aZ){return h.makeCustomWalletJSON(aZ,O,d)};this.makeCustomWalletJSON=function(a4,a0,a6){var a3=aJ;if(a4=="base64"){a3=ae}else{if(a4=="hex"){a3=k}else{if(a4=="sipa"){a3=h.base58ToSipa}else{if(a4=="base58"){a3=ay}}}}var aZ='{\n	"guid" : "'+a0+'",\n	"sharedKey" : "'+a6+'",\n';if(G&&w!=null&&a3==aJ){aZ+='	"double_encryption" : '+G+',\n	"dpasswordhash" : "'+w+'",\n'}if(s){aZ+='	"options" : '+JSON.stringify(s)+",\n"}aZ+='	"keys" : [\n';for(var a2 in K){var a5=$.extend({},K[a2]);if(a5.tag==1){delete a5.tag}if(a5.priv!=null){a5.priv=a3(a5.priv,a5.addr)}for(var a1 in a5){if(a5[a1]===null||a5[a1]===undefined){delete a5[a1]}}delete a5.balance;aZ+=JSON.stringify(a5)+",\n";atLeastOne=true}if(atLeastOne){aZ=aZ.substring(0,aZ.length-2)}aZ+="\n	]";if(aI(g)>0){aZ+=',\n	"address_book" : [\n';for(var a2 in g){aZ+='	{"addr" : "'+a2+'",\n';aZ+='	 "label" : "'+g[a2]+'"},\n'}aZ=aZ.substring(0,aZ.length-2);aZ+="\n	]"}if(aI(b)>0){aZ+=',\n	"tx_notes" : '+JSON.stringify(b)}aZ+="\n}";return aZ};this.get_history=function(a0,aZ){BlockchainAPI.get_history(function(a1){J(a1,false);if(F.length==0&&aA>0){h.setPage(0)}else{c()}if(a0){a0()}},function(){if(aZ){aZ()}},av,aA*h.getNTransactionsPerPage(),h.getNTransactionsPerPage())};this.deleteAddressBook=function(aZ){delete g[aZ];h.backupWalletDelayed();$("#send-coins").find(".tab-pane").trigger("show",true)};function u(aZ){$("#send-coins").find(".tab-pane.active").trigger("show",aZ);if(aZ){BlockchainAPI.get_ticker();$(".send").prop("disabled",false)}}function l(aZ,a0,a4){var a3=aZ.val();aZ.empty();for(var a2 in K){var a5=K[a2];if(!a5||a5.tag==2){continue}var a1=a5.label;if(!a1){a1=a5.addr.substring(0,15)+"..."}if(a0||a5.balance>0){aZ.prepend('<option value="'+a5.addr+'">'+a1+" - "+formatBTC(a5.balance)+"</option>")}}aZ.prepend('<option value="any" selected>Any Address</option>');if(!a4&&a3){aZ.val(a3)}}function r(a1,a2){l(a1.find('select[name="from"]'),false,a2);l(a1.find('select[name="change"]'),true,a2);a1.find('select[name="change"]').prepend('<option value="new">New Address</option>');a1.find(".local-symbol").text(symbol_local.symbol);a1.find(".btc-symbol").text(symbol_btc.symbol);if(a2){a1.find("input").val("");a1.find(".send-value-usd").text(formatSymbol(0,symbol_local)).val("");a1.find(".amount-needed").text(0)}var a0=a1.find(".recipient-container");if(a2){var a4=a0.find(".recipient:first-child").clone();a0.empty().append(a4)}function aZ(){var a5=BigInteger.ZERO;a1.find(".send-value").each(function(){a5=a5.add(precisionToSatoshiBN($(this).val()))});return a5}function a3(a5){a5.find('input[name="send-to-address"]').typeahead({source:aE()}).next().unbind().click(function(){var a6=$(this).prev();h.scanQRCode(function(a7){console.log(a7);try{new Bitcoin.Address(a7);a6.val(a7)}catch(a8){h.handleURI(a7,a5)}},function(a7){h.makeNotice("error","misc-error",a7)})});a5.find(".send-value").unbind().bind("keyup change",function(a6){if(a6.keyCode=="9"){return}a1.find(".amount-needed").text(formatBTC(aZ().toString()));a5.find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});a5.find(".send-value-usd").text(formatSymbol(0,symbol_local)).unbind().bind("keyup change",function(a6){if(a6.keyCode=="9"){return}a5.find(".send-value").val(formatSatoshi(parseFloat($(this).val())*symbol_local.conversion,sShift(symbol_btc),true))})}a0.find(".recipient").each(function(){a3($(this))});a1.find(".remove-recipient").unbind().click(function(){var a5=a0.find(".recipient").length;if(a5>1){if(a5==2){$(this).hide(200)}a0.find(".recipient:last-child").remove()}});a1.find(".add-recipient").unbind().click(function(){var a5=a0.find(".recipient:first-child").clone();a5.find('input[type="text"]').val("");a5.appendTo(a0);a3(a5);a1.find(".remove-recipient").show(200)});a1.find('select[name="from"]').unbind().change(function(){var a7=0;var a5=$(this).val();for(var a6 in a5){if(a5[a6]=="any"){$(this).val("any");a7=aC;break}else{var a8=K[a5[a6]];if(a8&&a8.balance){a7+=a8.balance}}}a1.find(".amount-available").text(formatBTC(a7))}).trigger("change")}this.getAllAddresses=function(){var a0=[];for(var aZ in K){a0.push(aZ)}return a0};this.getPreferredAddress=function(){var a0=null;for(var aZ in K){var a1=K[aZ];if(a0==null){a0=a1}if(a1.priv!=null){if(a0==null){a0=a1}if(a1.tag==null||a1.tag==0){a0=a1;break}}}return a0.addr};function aW(){var aZ=$("#restore-backup-modal");aZ.modal({keyboard:true,backdrop:"static",show:true});aZ.find(".btn.btn-secondary").unbind().click(function(){aZ.modal("hide")})}this.scanQRCode=function(a1,aZ){var a0=$("#qr-code-reader-modal");a0.modal({keyboard:false,backdrop:"static",show:true});loadScript("wallet/qr.code.reader",function(){QRCodeReader.init(a0,function(a2){QRCodeReader.stop();a0.modal("hide");a1(a2)},function(a2){a0.modal("hide");aZ(a2)})},aZ);a0.find(".btn.btn-secondary").unbind().click(function(){QRCodeReader.stop();a0.modal("hide");aZ()})};this.getActiveAddresses=function(){var a1=[];for(var aZ in K){var a0=K[aZ];if(a0.tag!=2){a1.push(a0.addr)}}return a1};this.getArchivedAddresses=function(){var a1=[];for(var aZ in K){var a0=K[aZ];if(a0.tag==2){a1.push(a0.addr)}}return a1};function aB(a2){if(a2!=null){aK=a2;for(var a0 in F){var aZ=F[a0];if(aZ.blockHeight!=null&&aZ.blockHeight>0){var a1=aK.height-aZ.blockHeight+1;if(a1<=100){aZ.setConfirmations(aK.height-aZ.blockHeight+1)}else{aZ.setConfirmations(null)}}else{aZ.setConfirmations(0)}}}}function A(a0,aZ){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Transaction Summary",description:"",src:root+"tx-summary/"+a0+"?result="+aZ+"&symbol_btc="+symbol_btc.code+"&symbol_local="+symbol_local.code})})}this.deleteNote=function(aZ){delete b[aZ];c();h.backupWalletDelayed()};function ah(aZ){return/^[\w\-,._  ]+$/.test(aZ)}function m(aZ,a0){(function(a2,a4){a2=$(a2);try{a2.data("popover").tip().remove();a2.removeData("popover")}catch(a5){}console.log("addNotePopover()");a2.popover({title:'Add Note <span style="float:right"><i class="icon-remove-sign"></i></span>',trigger:"manual",content:'<textarea style="width:97%;height:50px;margin-top:2px" placeholder="Enter the note here..."></textarea><div style="text-align:right"><button class="btn btn-small">Save</button></div>'});a2.popover("show");a2.unbind("mouseleave").mouseleave(function(){if(!a2.__timeout){a2.__timeout=setTimeout(function(){a2.popover("hide")},250)}});function a1(){if(a2.__timeout){clearTimeout(a2.__timeout);a2.__timeout=null}}var a3=a2.data("popover").tip().mouseenter(a1);a3.find("textarea").focus(a1);a3.mouseleave(function(){a2.__timeout=setTimeout(function(){a2.popover("hide")},250)});a3.find("i").unbind().click(function(){a2.popover("hide")});a3.find("button").click(function(){var a6=$.trim(a3.find("textarea").val());if(!ah(a6)){h.makeNotice("error","misc-error","Note must be contain letters and numbers only");return}if(a6.length>0){b[a4]=a6;h.backupWalletDelayed()}c()})})(aZ,a0)}function aO(aZ,a0,a1){(function(a2,a3,a5){a2=$(a2);try{a2.data("popover").tip().remove();a2.removeData("popover")}catch(a6){}var a7="Note";if(b[a5]){a7+=' <span style="float:right"><img src="'+resource+'delete.png" /></span>'}a2.popover({title:a7,trigger:"manual",content:a3});a2.popover("show");a2.unbind("mouseleave").mouseleave(function(){if(!a2.__timeout){a2.__timeout=setTimeout(function(){a2.popover("hide")},250)}});var a4=a2.data("popover").tip().mouseenter(function(){if(a2.__timeout){clearTimeout(a2.__timeout);a2.__timeout=null}});a4.find("img").unbind().click(function(){h.deleteNote(a5)});a4.mouseleave(function(){a2.__timeout=setTimeout(function(){a2.popover("hide")},250)})})(aZ,a0,a1)}function D(a2,a7,a4){var a8=a2.result;var a3='<tr class="pointer" id="tx-'+a2.txIndex+'"><td class="hidden-phone" style="width:365px"><div><ul style="margin-left:0px;" class="short-addr">';var a0=true;if(a8>=0){for(var a1=0;a1<a2.inputs.length;++a1){var aZ=a2.inputs[a1].prev_out;if(!aZ||!aZ.addr){a0=false;a3+='<span class="label">Newly Generated Coins</span>'}else{var a5=a7[aZ.addr];if(a5){continue}a0=false;a3+=formatOutput(aZ,a7,a4)}}}else{if(a8<0){for(var a1=0;a1<a2.out.length;++a1){var aZ=a2.out[a1];var a5=a7[aZ.addr];if(a5&&aZ.type==0){continue}a0=false;a3+=formatOutput(aZ,a7,a4)}}}if(a0){a3+='<span class="label">Moved Between Wallet</info>'}a3+="</ul></div></td><td><div>";var a6=a2.note?a2.note:b[a2.hash];if(a6){a3+='<img src="'+resource+'note.png" class="show-note"> '}else{a3+='<img src="'+resource+'note_grey.png" class="add-note"> '}if(a2.time>0){a3+=dateToString(new Date(a2.time*1000))}if(a2.confirmations==0){a3+=' <span class="label label-important hidden-phone">Unconfirmed Transaction!</span> '}else{if(a2.confirmations>0){a3+=' <span class="label label-info hidden-phone">'+a2.confirmations+" Confirmations</span> "}}a3+="</div></td>";if(a8>0){a3+='<td style="color:green"><div>'+formatMoney(a8,true)+"</div></td>"}else{if(a8<0){a3+='<td style="color:red"><div>'+formatMoney(a8,true)+"</div></td>"}else{a3+="<td><div>"+formatMoney(a8,true)+"</div></td>"}}if(a2.balance==null){a3+="<td></td></tr>"}else{a3+='<td class="hidden-phone"><div>'+formatMoney(a2.balance)+"</div></td></tr>"}return a3}function X(){N();if(aC==null){$("#balance").html("Loading...")}else{$("#balance").html(formatSymbol(aC,symbol,true));$("#balance2").html(formatSymbol(aC,(symbol===symbol_local)?symbol_btc:symbol_local),true)}return j.attr("id")}function c(aZ){var a0=X();if("send-coins"==a0){u(aZ)}else{if("home-intro"==a0){f(aZ)}else{if("receive-coins"==a0){aY(aZ)}else{if("my-transactions"==a0){Y(aZ)}}}}}function f(aZ){$("#summary-n-tx").html(M);$("#summary-received").html(formatMoney(aw,true));$("#summary-sent").html(formatMoney(U,true));$("#summary-balance").html(formatMoney(aC,symbol));var a1=h.getPreferredAddress();$(".paper-wallet-btn").unbind().click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showModal()})});if(h.isWatchOnly(a1)){$(".no-watch-only").hide()}else{$(".no-watch-only").show();var a0=$("#my-primary-address");if(a0.text()!=a1){a0.text(a1);loadScript("wallet/jquery.qrcode",function(){$("#my-primary-addres-qr-code").empty().qrcode({width:125,height:125,text:a1})})}}}function T(){var aZ=$("#export-warning").show();var a0=$("#import-export-content").hide();$("#show-import-export").unbind().click(function(){h.getMainPassword(function(){aZ.hide();loadScript("wallet/import-export",function(){ImportExport.init(a0,function(){a0.show()},function(){ai($("#home-intro"))})},function(a1){h.makeNotice("error","misc-error",a1);ai($("#home-intro"))})},function(){ai($("#home-intro"))})})}function Y(){var a0=null;var a2=0;if(a0!=null){clearInterval(a0);a0=null}var aZ;if(s.tx_display==0){$("#transactions-detailed").hide();aZ=$("#transactions-compact").show().find("tbody").empty()}else{$("#transactions-compact").hide();aZ=$("#transactions-detailed").empty().show()}if(F.length==0){$("#transactions-detailed, #transactions-compact").hide();$("#no-transactions").show();return}else{$("#no-transactions").hide()}var a1=function(){for(var a6=a2;a6<F.length&&a6<(a2+h.getNTransactionsPerPage());++a6){var a5=F[a6];if(s.tx_display==0){aZ.append(aU($(D(a5,K,g)),a5))}else{aZ.append(a5.getHTML(K,g))}}a2+=h.getNTransactionsPerPage();if(a2<F.length){a0=setTimeout(a1,15)}else{setupSymbolToggle();N();var a4=$(".pagination ul").empty();if(aA==0&&F.length<h.getNTransactionsPerPage()){a4.hide();return}else{a4.show()}var a3=Math.ceil(aX/h.getNTransactionsPerPage());var a8=" disabled";if(aA>0){a8=""}var a9=10;var a7=Math.max(0,Math.min(aA-(a9/2),a3-a9));a4.append($('<li class="prev'+a8+'"><a>&larr; Previous</a></li>').click(function(){h.setPage(aA-1)}));if(a7>0){a4.append($("<li><a>≤</a></li>").click(function(){h.setPage(0)}))}for(var a6=a7;a6<a3&&a6<a7+a9;++a6){(function(ba){var bb="";if(aA==ba){bb=' class="active"'}a4.append($("<li"+bb+'><a class="hidden-phone">'+(ba+1)+"</a></li>").click(function(){h.setPage(ba)}))})(a6)}if(a7+a9<a3){a4.append($("<li><a>≥</a></li>").click(function(){h.setPage(a3-1)}))}var a8=" disabled";if(aA<a3-1){a8=""}a4.append($('<li class="next'+a8+'"><a>Next &rarr;</a></li>').click(function(){h.setPage(aA+1)}))}};a1()}this.setPage=function(aZ){aA=aZ;scroll(0,0);h.get_history()};function v(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Export History",description:"",src:root+"export-history?active="+h.getActiveAddresses().join("|")+"&archived="+h.getArchivedAddresses().join("|")})})}function J(a2,a1){if(!a1){if(a2.mixer_fee){x=a2.mixer_fee}I=a2.recommend_include_fee;if(a2.info){if(a2.info.symbol_local){setLocalSymbol(a2.info.symbol_local)}if(a2.info.symbol_btc){setBTCSymbol(a2.info.symbol_btc)}}}if(a2.disable_mixer){$("#shared-addresses,#send-shared").hide()}aH=a2.sharedcoin_endpoint;F.length=0;if(a2.wallet==null){aw=0;U=0;aC=0;M=0;aX=0;return}aw=a2.wallet.total_received;U=a2.wallet.total_sent;aC=a2.wallet.final_balance;M=a2.wallet.n_tx;aX=a2.wallet.n_tx_filtered;for(var a0=0;a0<a2.addresses.length;++a0){if(K[a2.addresses[a0].address]){K[a2.addresses[a0].address].balance=a2.addresses[a0].final_balance}}for(var a0=0;a0<a2.txs.length;++a0){var aZ=TransactionFromJSON(a2.txs[a0]);aZ.result=t(aZ,false);F.push(aZ)}if(!a1){if(a2.info.latest_block){aB(a2.info.latest_block)}}}this.handleURI=function(a0,aZ){loadScript("wallet/jsuri-1.1.1",function(){try{var a2=new Uri(a0);var a1=new Bitcoin.Address(a2.host());aZ.find('input[name="send-to-address"]').val(a1.toString());var a3=parseFloat(a2.getQueryParamValue("amount"));if(a3>0&&!isNaN(a3)){aZ.find(".send-value").val(a3)}}catch(a4){console.log(a4);h.makeNotice("error","error","Invalid Bitcoin Address or URI")}},function(){h.makeNotice("error","error","Invalid Bitcoin Address or URI")})};function aQ(){L();W=setTimeout(h.logout,h.getLogoutTime());for(var a1 in ab){ab[a1]("did_decrypt")}MyStore.get("multiaddr",function(a3){if(a3!=null){J($.parseJSON(a3),true);c()}});h.get_history();$("#initial_error,#initial_success").remove();var a2=decodeURIComponent(window.location.hash.replace("#",""));if(a2.indexOf("bitcoin:")==0){var aZ=$("#send-coins");ai(aZ);var a0=aZ.find(".tab-pane.active").find(".recipient").first();h.handleURI(a2,a0)}else{ai($("#home-intro"))}window.location.hash=""}function L(a2,aZ){for(var a0 in K){var a3=K[a0];if(a3.tag==1){alert("Warning! wallet data may have changed but cannot sync as you have un-saved keys");return}}console.log("Get wallet with checksum "+aD);var a1={method:"wallet.aes.json",format:"json"};if(aD&&aD.length>0){a1.checksum=aD}h.securePost("wallet",a1,function(a4){if(!a4.payload||a4.payload=="Not modified"){if(a2){a2()}return}console.log("Wallet data modified");h.setEncryptedWalletData(a4.payload);ad(function(){h.get_history();c();if(a2){a2()}},function(){if(aZ){aZ()}})},function(a4){if(aZ){aZ()}})}function ad(a0,aZ){if(al==null||al.length==0){aZ("No Wallet Data To Decrypt");return}h.decryptWallet(al,aM,function(a8,a6){try{d=a8.sharedKey;if(!d||d.length==0||d.length!=36){throw"Shared Key is invalid"}if(a6){S=a6.version;R=a6.pbkdf2_iterations}if(a8.double_encryption&&a8.dpasswordhash){G=a8.double_encryption;w=a8.dpasswordhash}if(a8.options){$.extend(s,a8.options)}K={};for(var a2=0;a2<a8.keys.length;++a2){var a1=a8.keys[a2];if(a1.addr==null||a1.addr.length==0||a1.addr=="undefined"){h.makeNotice("error","null-error","Your wallet contains an undefined address. This is a sign of possible corruption, please double check all your BTC is accounted for. Backup your wallet to remove this error.",15000);continue}if(a1.tag==1){a1.tag=null}if(a1.label&&!ah(a1.label)){a1.label=null}K[a1.addr]=a1}g={};if(a8.address_book){for(var a2=0;a2<a8.address_book.length;++a2){var a4=a8.address_book[a2];if(a4.label&&ah(a4.label)){h.addAddressBookEntry(a4.addr,a4.label)}}}if(a8.tx_notes){for(var a5 in a8.tx_notes){var a3=a8.tx_notes[a5];if(a3&&ah(a3)){b[a5]=a3}}}if(aD==null||aD.length==0){aD=ak()}e();a0()}catch(a7){aZ(a7)}},aZ)}this.getPassword=function(a4,a5,a2){if(!a4.is(":visible")){a4.trigger("hidden");a4.unbind()}a4.modal({keyboard:false,backdrop:"static",show:true});a4.center();var a3=a4.find('input[name="password"]');var a7=a3,aZ=false,a6=false;a4.find(".vkeyboard li").unbind().click(function(){var ba=$(this),a9=ba.html();if(ba.hasClass("left-shift")||ba.hasClass("right-shift")){$(".letter").toggleClass("uppercase");$(".symbol span").toggle();aZ=(aZ===true)?false:true;a6=false;return false}if(ba.hasClass("capslock")){$(".letter").toggleClass("uppercase");a6=true;return false}if(ba.hasClass("delete")){var a8=a7.val();a7.val(a8.substr(0,a8.length-1));return false}if(ba.hasClass("symbol")){a9=$("span:visible",ba).html()}if(ba.hasClass("space")){a9=" "}if(ba.hasClass("tab")){a9="\t"}if(ba.hasClass("return")){a9="\n"}if(ba.hasClass("uppercase")){a9=a9.toUpperCase()}if(aZ===true){$(".symbol span").toggle();if(a6===false){$(".letter").toggleClass("uppercase")}aZ=false}a7.val(a7.val()+a9)});a3.keypress(function(a8){if(a8.keyCode==13){a8.preventDefault();a4.find(".btn.btn-primary").click()}});a3.val("");var a0=a4.find(".btn.btn-primary");a0.click(function(){if(a5){a2=null;var a8=a5;a5=null;setTimeout(function(){a4.modal("hide");a8(a3.val())},10)}else{a4.modal("hide")}});var a1=a4.find(".btn.btn-secondary");a1.click(function(){if(a2){var a8=a2;a2=null;a5=null;setTimeout(function(){a4.modal("hide");try{a8()}catch(a9){h.makeNotice("error","misc-error",a9)}},10)}else{a4.modal("hide")}});a4.on("hidden",function(){a3.unbind();a1.unbind();a0.unbind();a4.unbind();if(a2){var a8=a2;a2=null;a5=null;setTimeout(function(){try{a8()}catch(a9){h.makeNotice("error","misc-error",a9)}},10)}})};this.makePairingQRCode=function(a0,aZ){h.getMainPassword(function(){loadScript("wallet/jquery.qrcode",function(){try{if(aZ==1){h.securePost("wallet",{method:"pairing-encryption-password"},function(a2){a0($("<div></div>").qrcode({width:300,height:300,text:"1|"+O+"|"+h.encrypt(d+"|"+Crypto.util.bytesToHex(UTF8.stringToBytes(aM)),a2,h.getDefaultPbkdf2Iterations())}))},function(a2){h.makeNotice("error","misc-error",a2)})}else{if(aZ==0){a0($("<div></div>").qrcode({width:300,height:300,text:O+"|"+d+"|"+aM}))}}}catch(a1){h.makeNotice("error","misc-error",a1)}})},function(){h.logout()})};this.getMainPassword=function(a0,aZ){if(C>new Date().getTime()-P){return a0(aM)}h.getPassword($("#main-password-modal"),function(a1){if(aM==a1){C=new Date().getTime();if(a0){try{a0(aM)}catch(a2){h.makeNotice("error","misc-error",a2)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aZ){try{aZ()}catch(a2){h.makeNotice("error","misc-error",a2)}}}},aZ)};this.getSecondPassword=function(a1,aZ){if(!G||an!=null){if(a1){try{a1(an)}catch(a0){h.makeNotice("error","misc-error",a0)}}return}h.getPassword($("#second-password-modal"),function(a2){try{if(aN(a2)){if(a1){try{a1(a2)}catch(a3){console.log(a3);h.makeNotice("error","misc-error",a3)}}}else{h.makeNotice("error","misc-error","Password incorrect.");if(aZ){try{aZ()}catch(a3){h.makeNotice("error","misc-error",a3)}}}}catch(a3){if(aZ){try{aZ()}catch(a3){h.makeNotice("error","misc-error",a3)}}}},aZ)};function a(){if(B||az){return}try{az=true;var aZ=$("#restore-password");aM=aZ.val();aZ.val("");C=new Date().getTime();function a0(a3){az=false;h.makeNotice("error","misc-error",a3)}if(al==null||al.length==0){h.setLoadingText("Validating Authentication key");var a1=$.trim($(".auth-"+q).find(".code").val());if(a1.length==0||a1.length>255){throw"You must enter a Two Factor Authentication code"}$.ajax({type:"POST",url:root+"wallet",data:{guid:O,payload:a1,length:a1.length,method:"get-wallet",format:"plain"},success:function(a3){try{if(a3==null||a3.length==0){throw"Server Return Empty Wallet Data"}if(a3!="Not modified"){h.setEncryptedWalletData(a3)}$(".auth-"+q).hide();$(".auth-0").show();ad(function(){az=false;n();aQ()},a0)}catch(a4){a0(a4)}},error:function(a3){a0(a3.responseText)}})}else{ad(function(){az=false;n();aQ()},a0)}}catch(a2){a0(a2)}}function Q(){$("#not-synced-warning-modal").modal("show").find(".btn.btn-danger").unbind().click(function(){$(this).modal("hide");au=true;c()})}function e(){if(B){return}ax("error");webSocketConnect(y);B=true;$("#tech-faq").hide();$("#intro-text").hide();$("#large-summary").show()}this.quickSendNoUI=function(a1,a0,aZ){loadScript("wallet/signer",function(){h.getSecondPassword(function(){try{var a3=initNewTx();a3.from_addresses=h.getActiveAddresses();a3.to_addresses.push({address:new Bitcoin.Address(a1),value:Bitcoin.Util.parseValue(a0)});a3.addListener(aZ);a3.start()}catch(a2){aZ.on_error(a2)}},function(a2){aZ.on_error(a2)})})};function H(){h.setLoadingText("Sending email backup");h.securePost("wallet",{method:"email-backup"},function(aZ){h.makeNotice("success","backup-success",aZ)},function(aZ){h.makeNotice("error","misc-error",aZ.responseText)})}this.backupWalletDelayed=function(a2,a1,a0,aZ){if(ap){clearInterval(ap);ap=null}ap=setTimeout(function(){h.backupWallet(a2,a1,a0,aZ)},3000)};this.backupWallet=function(a5,a4,a0){if(ap){clearInterval(ap);ap=null}var aZ=function(a6){h.makeNotice("error","misc-error","Error Saving Wallet: "+a6,10000);c();if(a0!=null){a0(a6)}else{throw a6}};try{if(a5==null){a5="update"}if(aI(K)==0){return}var a1=h.makeWalletJSON();var a3=h.encryptWallet(a1,aM);if(a3.length==0){throw"Error encrypting the JSON output"}h.decryptWallet(a3,aM,function(a9){try{var a6=aD;h.setLoadingText("Saving wallet");h.setEncryptedWalletData(a3);var a7={length:a3.length,payload:a3,checksum:aD,old_checksum:a6,method:a5,format:"plain",language:Z};if(z){a7.active=h.getActiveAddresses().join("|")}h.securePost("wallet",a7,function(bb){for(var ba in K){var bc=K[ba];if(bc.tag==1){delete bc.tag}}h.makeNotice("success","misc-success",bb);c();if(a4!=null){a4()}},function(bb){for(var ba in K){var bc=K[ba];if(bc.tag==1){Q();break}}aZ(bb.responseText)})}catch(a8){aZ(a8)}})}catch(a2){aZ(a2)}};function aR(aZ){if(G){if(an==null){throw"Cannot encrypt private key without a password"}return h.encrypt(aZ,d+an,h.getSecondPasswordPbkdf2Iterations())}else{return aZ}return null}this.isBase58=function(a1,a0){for(var aZ=0;aZ<a1.length;++aZ){if(a1[aZ]<0||a1[aZ]>58){return false}}return true};this.encrypt=function(a1,a0,aZ){return Crypto.AES.encrypt(a1,a0,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aZ})};this.encryptWallet=function(a0,aZ){if(S==2){return JSON.stringify({pbkdf2_iterations:h.getMainPasswordPbkdf2Iterations(),version:S,payload:h.encrypt(a0,aZ,h.getMainPasswordPbkdf2Iterations())})}else{if(S==0){return h.encrypt(a0,aZ,h.getDefaultPbkdf2Iterations())}else{throw"Unknown encryption version "+S}}};this.decryptWallet=function(a0,a6,a7,a3){try{var aZ=null;try{var aZ=$.parseJSON(a0)}catch(a1){console.log(a1)}var a2=function(){try{var a9=Crypto.AES.decrypt(aZ.payload,a6,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:aZ.pbkdf2_iterations});var a8=$.parseJSON(a9);a7(a8,aZ)}catch(ba){a3("Error Decrypting Wallet. Please check your password is correct.")}};if(aZ&&aZ.payload&&aZ.pbkdf2_iterations){if(aZ.version!=ar){throw"Wallet version "+aZ.version+" not supported"}if(aZ.pbkdf2_iterations>100){var a5=$("#decrypting-progress-modal");var a4=setTimeout(function(){a5.modal({keyboard:false,backdrop:"static",show:true});a5.center()},500);h.decryptWebWorker(aZ.payload,a6,aZ.pbkdf2_iterations,function(a9){clearTimeout(a4);a5.modal("hide");try{var a8=$.parseJSON(a9);a7(a8,aZ)}catch(ba){a2()}},function(){clearTimeout(a4);a5.modal("hide");a2()})}else{a2()}}else{h.decrypt(a0,a6,h.getDefaultPbkdf2Iterations(),function(a9){try{var a8=$.parseJSON(a9);try{a7(a8)}catch(ba){console.log(ba)}return true}catch(ba){return false}},function(){a3("Error Decrypting Wallet. Please check your password is correct.")})}}catch(a1){if(a3){a3(a1)}}};this.decryptWebWorker=function(a2,a6,a1,a7,a5){var aZ=false;var a4=function(a8){if(!aZ){a5(a8);aZ=true}};try{var a0=new Worker(resource+"wallet/signer"+(min?".min.js":".js"));a0.addEventListener("message",function(a9){var a8=a9.data;try{switch(a8.cmd){case"on_decrypt":a7(a8.data);a0.terminate();break;case"on_error":throw a8.e}}catch(a9){a0.terminate();a4(a9)}},false);a0.addEventListener("error",function(a8){a4(a8)});a0.postMessage({cmd:"load_resource",path:resource+"wallet/bitcoinjs"+(min?".min.js":".js")});a0.postMessage({cmd:"decrypt",data:a2,password:a6,pbkdf2_iterations:a1})}catch(a3){a4(a3)}};this.decrypt=function(a3,a2,a0,a5,a1){try{var aZ=Crypto.AES.decrypt(a3,a2,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:a0});if(aZ!=null&&aZ.length>0){if(a5(aZ)){return aZ}}}catch(a4){console.log(a4)}if(a0!=10){try{var aZ=Crypto.AES.decrypt(a3,a2,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:10});if(aZ!=null&&aZ.length>0){if(a5(aZ)){return aZ}}}catch(a4){console.log(a4)}}try{var aZ=Crypto.AES.decrypt(a3,a2);if(aZ!=null&&aZ.length>0){if(a5(aZ)){return aZ}}}catch(a4){console.log(a4)}try{var aZ=Crypto.AES.decrypt(a3,a2,{mode:new Crypto.mode.OFB(Crypto.pad.iso7816),iterations:1});if(aZ!=null&&aZ.length>0){if(a5(aZ)){return aZ}}}catch(a4){console.log(a4)}try{var aZ=Crypto.AES.decrypt(a3,a2,{mode:new Crypto.mode.CBC(Crypto.pad.iso10126),iterations:1});if(aZ!=null&&aZ.length>0){if(a5(aZ)){return aZ}}}catch(a4){console.log(a4)}if(a1){a1()}return null};this.handleNTPResponse=function(a3,a4){var a1=(new Date()).getTime();if(a3.clientTimeDiff&&a3.serverTime){var aZ=a1-a3.serverTime;var a0=(a3.clientTimeDiff-a1+a4-aZ)/2;var a2=(aZ-a0)/2;if(aa){aP=(aP+a2)/2}else{aP=a2;aa=true;MyStore.put("server_time_offset",""+aP)}console.log("Server Time offset "+aP+"ms - This offset "+a2)}};this.setGUID=function(a1,aZ){console.log("Set GUID "+a1);if(B){throw"Cannot Set GUID Once Initialized"}h.setLoadingText("Changing Wallet Identifier");$("#initial_error,#initial_success").remove();var a0=$("#restore-wallet-continue");a0.prop("disabled",true);var a3=(new Date()).getTime();var a2={format:"json",resend_code:aZ,ct:a3};if(aD){a2.checksum=aD}$.ajax({type:"GET",dataType:"json",url:root+"wallet/"+a1,data:a2,timeout:10000,success:function(a4){h.handleNTPResponse(a4,a3);a0.prop("disabled",false);if(!a4.guid){h.makeNotice("error","misc-error","Server returned null guid.");return}$(".auth-"+q).hide();ac=a4.extra_seed;O=a4.guid;q=a4.auth_type;aS=a4.real_auth_type;z=a4.sync_pubkeys;if(a4.payload&&a4.payload.length>0&&a4.payload!="Not modified"){h.setEncryptedWalletData(a4.payload)}war_checksum=a4.war_checksum;setLocalSymbol(a4.symbol_local);setBTCSymbol(a4.symbol_btc);$("#restore-guid").val(O);$(".auth-"+q).show();if(a4.initial_error){h.makeNotice("error","misc-error",a4.initial_error)}if(a4.initial_success){h.makeNotice("success","misc-success",a4.initial_success)}MyStore.get("guid",function(a5){if(a5!=O){MyStore.remove("guid");MyStore.remove("payload");MyStore.remove("multiaddr");if(O!=E){MyStore.put("guid",O)}}});if(a4.language&&Z!=a4.language){h.setLanguage(a4.language)}},error:function(a4){a0.prop("disabled",false);MyStore.get("guid",function(a5){if(a5==a1&&al){h.makeNotice("error","misc-error","Error Contacting Server. Using Local Wallet Cache.");O=a5;aD=ak();q=0;$("#restore-guid").val(O);$(".auth-"+q).show();return}try{var a7=$.parseJSON(a4.responseText);if(a7.authorization_required){loadScript("wallet/poll-for-session-guid",function(){pollForSessionGUID()})}if(a7.initial_error){h.makeNotice("error","misc-error",a7.initial_error)}return}catch(a6){}if(a4.responseText){h.makeNotice("error","misc-error",a4.responseText)}else{h.makeNotice("error","misc-error","Error changing wallet identifier")}})}})};function i(aZ){var a0=B58.encode(aZ);return aR(a0)}this.decryptPK=function(aZ){if(G){if(an==null){throw"Cannot decrypt private key without a password"}return h.decrypt(aZ,d+an,h.getSecondPasswordPbkdf2Iterations(),h.isBase58)}else{return aZ}return null};this.decodePK=function(a0){if(!a0){throw"null PK passed to decodePK"}var aZ=h.decryptPK(a0);if(aZ!=null){return B58.decode(aZ)}return null};this.signmessage=function(aZ,a1){var a3=K[aZ];if(!a3.priv){throw"Cannot sign a watch only address"}var a2=h.decodePK(a3.priv);var a0=new Bitcoin.ECKey(a2);return Bitcoin.Message.signMessage(a0,a1,a3.addr)};function aN(a0){var aZ=Crypto.SHA256(d+a0,{asBytes:true});var a3=ag(aZ,h.getSecondPasswordPbkdf2Iterations()-1);if(a3==w){an=a0;return true}if(h.getSecondPasswordPbkdf2Iterations()!=10){var a1=ag(aZ,10-1);if(a1==w){an=a0;w=a3;return true}}if(Crypto.util.bytesToHex(aZ)==w){an=a0;w=a3;return true}var a2=Crypto.SHA256(a0);if(a2==w){an=a0;w=a3;return true}return false}this.runCompressedCheck=function(){var aZ=[];var a1={};for(var a2 in K){var a6=K[a2];if(a6.priv!=null){var a5=h.decodePK(a6.priv);var a3=new Bitcoin.ECKey(a5);var a0=a3.getBitcoinAddress().toString();var a4=a3.getBitcoinAddressCompressed().toString();if(a6.addr!=a0){a1[a0]=a6.priv;aZ.push(a0)}if(a6.addr!=a4){a1[a4]=a6.priv;aZ.push(a4)}}}if(aZ.length==0){alert("to_check length == 0")}BlockchainAPI.get_balances(aZ,function(ba){var bb=0;for(var a9 in ba){var bc=ba[a9].final_balance;if(bc>0){var a8=new Bitcoin.ECKey(h.decodePK(a1[a9]));var a7=a8.getBitcoinAddress().toString();if(h.addPrivateKey(a8,{compressed:a7!=a9,app_name:IMPORTED_APP_NAME,app_version:IMPORTED_APP_VERSION})){alert(formatBTC(bc)+" claimable in address "+a9)}}bb+=bc}alert(formatBTC(bb)+" found in compressed addresses");if(bb>0){h.backupWallet("update",function(){h.get_history()})}})};this.checkAllKeys=function(aZ){for(var a0 in K){var a4=K[a0];if(a4.addr==null){throw"Null Address Found in wallet "+a0}if(a4.addr.toString()==null){throw"Error decoding wallet address "+a4.addr}if(a4.priv!=null){var a3=h.decodePK(a4.priv);var a2=new Bitcoin.ECKey(a3);var a1=a2.getBitcoinAddress().toString();if(a1!=a4.addr&&a2.getBitcoinAddressCompressed().toString()!=a4.addr){throw"Private key does not match bitcoin address "+a4.addr+" != "+a1}if(aZ){a4.priv=i(a3)}}}h.makeNotice("success","wallet-success","Wallet verified.")};this.setMainPassword=function(aZ){h.getMainPassword(function(){aM=aZ;h.backupWallet("update",function(){h.logout()},function(){h.logout()})})};function ai(aZ){if(aZ===j){return}if(j!=null){if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","")}j.hide()}j=aZ;j.show();if($("#"+j.attr("id")+"-btn").length>0){$("#"+j.attr("id")+"-btn").parent().attr("class","active")}c(true)}function aI(a1){var a0=0,aZ;for(aZ in a1){a0++}return a0}function af(aZ){K[aZ].priv=null}function am(){if(aI(K)>=aF){h.makeNotice("error","misc-error","We currently support a maximum of "+aF+" private keys, please remove some unused ones.");return true}return false}function aV(a1,aZ){var a0=K[a1];if(!a0||a0.length==0){K[a1]={addr:a1,priv:aZ,balance:0};return true}else{if(!a0.priv&&aZ){a0.priv=aZ;return true}}return false}function o(){var a1=$("#add-address-book-entry-modal");a1.modal({keyboard:true,backdrop:"static",show:true});var aZ=a1.find('input[name="label"]');var a0=a1.find('input[name="address"]');aZ.val("");a0.val("");a1.find(".btn.btn-primary").unbind().click(function(){a1.modal("hide");var a3=$.trim(aZ.val());var a2=$.trim(a0.val());if(a3.length==0||a2.length==0){h.makeNotice("error","misc-error","You must enter an address and label for the address book entry");return false}if(!ah(a3)||!ah(a2)){h.makeNotice("error","misc-error","Label and Bitcoin Address must contain letters and numbers only");return false}var a5;try{a5=new Bitcoin.Address(a2);if(a5==null){throw"Null address"}}catch(a4){h.makeNotice("error","misc-error","Bitcoin address invalid, please make sure you entered it correctly");return false}if(g[a2]!=null){h.makeNotice("error","misc-error","Bitcoin address already exists");return false}h.makeNotice("success","misc-success","Added Address book entry");h.addAddressBookEntry(a2,a3);h.backupWalletDelayed();$("#send-coins").find(".tab-pane").trigger("show",true)});a1.find(".btn.btn-secondary").unbind().click(function(){a1.modal("hide")})}this.logout=function(){if(at){return}if(O==E){window.location=root+"wallet/logout"}else{$.ajax({type:"GET",url:root+"wallet/logout",data:{format:"plain"},success:function(aZ){window.location.reload()},error:function(){window.location.reload()}})}};function aq(a5){var a7=$("#delete-address-modal");a7.modal({keyboard:true,backdrop:"static",show:true});a7.find(".btn.btn-primary").hide();a7.find(".btn.btn-danger").hide();$("#change-mind").hide();a7.find("#to-delete-address").html(a5.join(" "));a7.find("#delete-balance").empty();var a1=a7.find("#delete-balance");var aZ=[];for(var a4 in a5){var a6=a5[a4];if(K[a6]&&K[a6].priv){aZ.push(a5[a4])}}BlockchainAPI.get_balance(aZ,function(a8){a7.find(".btn.btn-primary").show(200);a7.find(".btn.btn-danger").show(200);a1.html("Balance "+formatBTC(a8));if(a8>0){a1.css("color","red")}else{a1.css("color","black")}},function(){a7.find(".btn.btn-primary").show(200);a7.find(".btn.btn-danger").show(200);a1.text("Error Fetching Balance")});var a2=false;var a4=0;var a0=null;var a3=10;changeMind=function(){$("#change-mind").show();$("#change-mind-time").text(a3-a4)};a7.find(".btn.btn-primary").unbind().click(function(){changeMind();a7.find(".btn.btn-primary").hide();a7.find(".btn.btn-danger").hide();a0=setInterval(function(){if(a2){return}++a4;changeMind();if(a4==a3){$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Private Key Removed From Wallet");for(var a8 in a5){af(a5[a8])}c();h.backupWallet();clearInterval(a0)}},1000)});a7.find(".btn.btn-danger").unbind().click(function(){changeMind();a7.find(".btn.btn-primary").hide();a7.find(".btn.btn-danger").hide();a0=setInterval(function(){if(a2){return}++a4;changeMind();if(a4==a3){try{$("#delete-address-modal").modal("hide");h.makeNotice("warning","warning-deleted","Address & Private Key Removed From Wallet");for(var a8 in a5){h.deleteAddress(a5[a8])}c();h.backupWallet("update",function(){h.get_history()})}finally{clearInterval(a0)}}},1000)});a7.unbind().on("hidden",function(){if(a0){a2=true;clearInterval(a0);a0=null}});a7.find(".btn.btn-secondary").unbind().click(function(){a7.modal("hide")})}function aE(){var a1=[];for(var aZ in g){a1.push(g[aZ])}for(var aZ in K){var a0=K[aZ];if(a0.tag!=2&&a0.label){a1.push(a0.label)}}return a1}this.sweepAddressesModal=function(a0,aZ){h.getSecondPassword(function(){var a2=$("#sweep-address-modal");a2.modal("show");BlockchainAPI.get_balance(a0,function(a3){a2.find(".balance").text("Amount: "+formatBTC(a3))},function(){a2.find(".balance").text("Error Fetching Balance")});var a1=a2.find('select[name="change"]');l(a1,true);a2.find(".btn.btn-primary").unbind().click(function(){loadScript("wallet/signer",function(){BlockchainAPI.get_balance(a0,function(a4){var a5=initNewTx();var a3=a1.val();if(a3=="any"){a3=h.getPreferredAddress()}a5.fee=a5.base_fee;a5.to_addresses.push({address:new Bitcoin.Address(a3),value:BigInteger.valueOf(a4).subtract(a5.fee)});a5.from_addresses=a0;a5.extra_private_keys=aZ;a5.start()},function(){h.makeNotice("error","misc-error","Error Getting Address Balance")})});a2.modal("hide")});a2.find(".btn.btn-secondary").unbind().click(function(){a2.modal("hide")})})};this.openWindow=function(a0){function aZ(a2){var a1=false;try{if(typeof a2=="undefined"||!a2){a1=true}else{if(a2&&a2.closed){a1=false}else{if(a2&&a2.test){a1=false}}}}catch(a3){}return a1}window.open(a0,null,"scroll=1,status=1,location=1,toolbar=1");if(aZ(window)){h.makeNotice("error","misc-error","Popup Blocked. Try and click again.");return false}else{return true}};function aG(){try{$(".pop").popover({offset:10,placement:"bottom"})}catch(aZ){}}function n(){if(V){return}V=true;$("#add-address-book-entry-btn").click(function(){o()});$("#home-intro-btn").click(function(){ai($("#home-intro"))});$("#my-transactions-btn").click(function(){ai($("#my-transactions"))});$("#send-coins-btn").click(function(){ai($("#send-coins"))});$("#import-export-btn").click(function(){ai($("#import-export"));T()});$("#chord-diagram").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Address Relationships",description:"",src:root+"taint/"+h.getActiveAddresses().join("|")})})});$("#verify-message").click(function(){loadScript("wallet/address_modal",function(){verifyMessageModal()})});$("#generate-cold-storage").click(function(){loadScript("wallet/paper-wallet",function(){PaperWallet.showColdStorageModal()},null,true)});$("#group-received").click(function(){loadScript("wallet/taint_grouping",function(){try{loadTaintData()}catch(aZ){h.makeNotice("error","misc-error","Unable To Load Taint Grouping Data")}})});$("#my-account-btn").click(function(){ai($("#my-account"));var aZ=$("#account-settings-warning").show();var a0=$("#my-account-content").hide();$("#show-account-settings").unbind().click(function(){h.getMainPassword(function(){aZ.hide();loadScript("wallet/account",function(){AccountSettings.init(a0,function(){a0.show()},function(){ai($("#home-intro"))})},function(a1){h.makeNotice("error","misc-error",a1);ai($("#home-intro"))})},function(){ai($("#home-intro"))})})});$("#enable_archived_checkbox").change(function(){var aZ=$(this).is(":checked");$(".archived_checkbox").prop("checked",false);$(".archived_checkbox").prop("disabled",!aZ);$("#archived-sweep").prop("disabled",!aZ);$("#archived-delete").prop("disabled",!aZ)});$("#shared-addresses").on("show",function(){var aZ=$(this);loadScript("wallet/shared-addresses",function(){buildSharedTable(aZ)})});$("#active-addresses").on("show",function(){var a5=$(this).find("table:first");a5.find("tbody:gt(0)").remove();var a2=a5.find("tbody").empty();for(var a4 in K){var a6=K[a4];if(a6.tag==2||(a6.tag==1&&!au)){continue}var a3="";if(a6.tag==1){a3=' <font color="red" class="pop" title="Not Synced" data-content="This is a new address which has not yet been synced with our the server. Do not used this address yet.">(Not Synced)</font>'}else{if(a6.priv==null){a3=' <font color="red" class="pop" title="Watch Only" data-content="Watch Only means there is no private key associated with this bitcoin address. <br /><br /> Unless you have the private key stored elsewhere you do not own the funds at this address and can only observe the transactions.">(Watch Only)</font>'}}var aZ="";var a1=a6.addr;if(a6.label!=null){a1=a6.label;aZ='<span class="hidden-phone"> - '+a6.addr+"</span>"}var a0=$('<tr><td><div class="short-addr"><a href="'+root+"address/"+a6.addr+'" target="new">'+a1+"</a>"+aZ+" "+a3+'<div></td><td><span style="color:green">'+formatMoney(a6.balance,true)+'</span></td>            <td><div class="btn-group pull-right"><a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#"><span class="hidden-phone">Actions </span><span class="caret"></span></a><ul class="dropdown-menu">             <li><a href="#" class="pop act-archive" title="Archive Address" data-content="Click this button to hide the address from the main view. You can restore or delete later by finding it in the Archived addresses tab.">Archive Address</a></li>            <li><a href="#" class="pop act-label" title="Label Address" data-content="Set the label for this address.">Label Address</a></li>            <li><a href="#" class="pop act-qr" title="Show QR Code" data-content="Show a QR Code for this address.">QR Code</a></li>            <li><a href="#" class="pop act-sign" title="Sign Message" data-content="Sign A message with this address.">Sign Message</a></li>            <li><a href="#" class="pop act-request" title="Request Payment" data-content="Click here to create a new QR Code payment request. The QR Code can be scanned using most popular bitcoin software and mobile apps.">Create Payment Request</a></li>            <li><a href="#" class="pop act-pubkey">Show Public Key</a></li>            </ul></div></td></tr>');(function(a7){a0.find(".act-archive").click(function(){h.archiveAddr(a7)});a0.find(".act-label").click(function(){loadScript("wallet/address_modal",function(){showLabelAddressModal(a7)})});a0.find(".act-qr").click(function(){loadScript("wallet/address_modal",function(){showAddressModalQRCode(a7)})});a0.find(".act-pubkey").click(function(){h.getSecondPassword(function(){var a8=h.getPrivateKey(a7);if(a8==null){h.makeNotice("eror","misc-error","Public Key Unknown");return}var a9=new Bitcoin.ECKey(h.decodePK(a8));if(a9.getBitcoinAddressCompressed().toString()==a7){var ba=a9.getPubCompressed()}else{var ba=a9.getPub()}h.makeNotice("success","pub-key","Public Key of "+a7+" is "+Crypto.util.bytesToHex(ba),20000)})});a0.find(".act-sign").click(function(){loadScript("wallet/address_modal",function(){showAddressModalSignMessage(a7)})});a0.find(".act-request").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Create Payment Request",description:"Request Payment into address <b>"+a7+"</b>",src:root+"payment_request?address="+a7})})})})(a6.addr);if(a6.balance>0&&a6.priv){a5.prepend(a0)}else{a5.append(a0)}}aG()});$("#archived-addresses").on("show",function(){$("#enable_archived_checkbox").prop("checked",false);$("#archived-delete").prop("disabled",true);$("#archived-sweep").prop("disabled",true);$("#archived-addr tbody").empty();var a0=$(this).find("tbody");var aZ=h.getArchivedAddresses();var a1=function(){a0.empty();for(var a5 in aZ){var a7=K[aZ[a5]];if(a7.tag!=2||(a7.tag==1&&!au)){continue}var a4="";if(a7.priv==null){a4=' <font color="red">(Watch Only)</font>'}var a2="";var a3=a7.addr;if(a7.label!=null){a3=a7.label;a2='<span class="hidden-phone"> - '+a7.addr+"</span>"}var a6=$('<tr><td style="width:20px;"><input type="checkbox" class="archived_checkbox" value="'+a7.addr+'" disabled></td><td><div class="short-addr"><a href="'+root+"address/"+a7.addr+'" target="new">'+a3+"</a>"+a2+" "+a4+'<div></td><td><span style="color:green">'+formatBTC(a7.balance)+'</span></td><td style="width:16px"><img src="'+resource+'unarchive.png" class="act-unarchive" /></td></tr>');(function(a8){a6.find(".act-unarchive").click(function(){h.unArchiveAddr(a8)})})(a7.addr);if(a7.balance>0&&a7.priv){a0.prepend(a6)}else{a0.append(a6)}}};a1();BlockchainAPI.get_balances(aZ,function(a2){a1()},function(a2){h.makeNotice("error","misc-error",a2)})});$("#archived-sweep").click(function(){var aZ=[];$(".archived_checkbox:checked").each(function(){var a0=K[$(this).val()];if(a0.priv==null){h.makeNotice("error","misc-error","Cannot Sweep Watch Only Address");return}aZ.push(a0.addr)});if(aZ.length==0){return}h.sweepAddressesModal(aZ)});$("#archived-delete").click(function(){var aZ=[];$(".archived_checkbox:checked").each(function(){aZ.push($(this).val())});if(aZ.length==0){return}aq(aZ)});$("#shared-never-ask").click(function(){SetCookie("shared-never-ask",$(this).is(":checked"))});$(".deposit-btn").click(function(){var a1=$(this);var a0=h.getPreferredAddress();var aZ=a1.data("extra");if(aZ==null){aZ=""}loadScript("wallet/frame-modal",function(){showFrameModal({title:a1.data("title"),description:"Deposit into address <b>"+a0+"</b>",top_right:'Have Questions? Read <a href="'+a1.data("link")+'" target="new">How It Works</a>',src:root+"deposit?address="+a0+"&ptype="+a1.data("type")+"&guid="+O+aZ})})});$(".withdraw-btn").click(function(){var aZ=$(this);h.getSecondPassword(function(){var a0=h.getPreferredAddress();loadScript("wallet/frame-modal",function(){showFrameModal({title:aZ.data("title"),description:"Your Wallet Balance is <b>"+formatBTC(aC)+"</b>",src:root+"withdraw?method="+aZ.data("type")+"&address="+a0+"&balance="+aC+"&guid="+O})})})});$("#logout").click(h.logout);$("#refresh").click(function(){L();h.get_history()});$("#summary-n-tx-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Number of transactions",description:"",src:root+"charts/n-transactions?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-received-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"BTC Received Per Day",description:"",src:root+"charts/received-per-day?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#summary-balance-chart").click(function(){loadScript("wallet/frame-modal",function(){showFrameModal({title:"Wallet Balance",description:"",src:root+"charts/balance?show_header=false&address="+h.getActiveAddresses().join("|")})})});$("#new-addr").click(function(){try{L(function(){h.getSecondPassword(function(){var a1=h.generateNewKey();if(!a1){return}var a0=a1.getBitcoinAddress().toString();h.backupWallet("update",function(){h.makeNotice("info","new-address","Generated new Bitcoin Address "+a0);loadScript("wallet/address_modal",function(){showLabelAddressModal(a0)});h.get_history()})})})}catch(aZ){h.makeNotice("error","misc-error",aZ)}});$(".tx_filter a").click(function(){aA=0;av=$(this).data("value");h.get_history()});$(".tx_display a").click(function(){var aZ=$(this).data("value");if(aZ=="export"){v();return}s.tx_display=aZ;c();h.backupWalletDelayed()});$("#email-backup-btn").click(function(){H()});$("#dropbox-backup-btn").click(function(){h.openWindow(root+"wallet/dropbox-login?guid="+O)});$("#gdrive-backup-btn").click(function(){h.openWindow(root+"wallet/gdrive-login?guid="+O)});$("#balance").click(function(){toggleSymbol();c()});$("#send-quick").on("show",function(a1,a0){var aZ=$(this);r(aZ,a0);aZ.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aZ,"quick",initNewTx())})})});$("#send-email").on("show",function(a1,a0){var aZ=$(this);r(aZ,a0);aZ.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aZ,"email",initNewTx())})})});$("#send-shared").on("show",function(a1,a0){var aZ=$(this);r(aZ,a0);aZ.find(".mixer_fee").text(x);aZ.find(".fees,.free,.bonus").show();if(x<0){aZ.find(".fees,.free").hide()}else{if(x==0){aZ.find(".fees,.bonus").hide()}else{aZ.find(".free,.bonus").hide()}}aZ.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){startTxUI(aZ,"shared",initNewTx())})});aZ.find(".shared-fees").text("0.00");aZ.find('input[name="send-before-fees"]').unbind().bind("keyup change",function(){var a3=parseFloat($(this).val());var a2=0;if(a3>0){if(x>0){a2=parseFloat(a3+((a3/100)*x))}else{a2=parseFloat(a3);aZ.find(".bonus-value").text(formatPrecision((Math.min(a3,precisionFromBTC(200))/100)*x))}}if(precisionToBTC(a3)<0.1||precisionToBTC(a3)>250){aZ.find(".shared-fees").text("0.00");aZ.find(".send").prop("disabled",true)}else{aZ.find(".shared-fees").text(formatBTC(a2*symbol_btc.conversion));aZ.find(".send").prop("disabled",false)}aZ.find(".send-value").val(a2).trigger("keyup")})});$("#send-custom").on("show",function(a1,a0){var aZ=$(this);r(aZ,a0);aZ.find(".send").unbind().click(function(){var a2=false;if(aZ.find('textarea[name="public-note"]').val()){aZ.find(".send-value").each(function(){if($(this).val()<0.0001){h.makeNotice("error","misc-error","You cannot attach a note to a transaction with an output size less than 0.0001 BTC");a2=true;return false}})}if(!a2){loadScript("wallet/signer",function(){startTxUI(aZ,"custom",initNewTx())})}});aZ.find('input[name="fees"]').unbind().bind("keyup change",function(a2){if(a2.keyCode=="9"){return}$(this).parent().find(".send-value-usd").val(convert($(this).val()*symbol_btc.conversion,symbol_local.conversion)).text(formatSymbol($(this).val()*symbol_btc.conversion,symbol_local))});aZ.find(".reset").unbind().click(function(){r(aZ,true);aZ.find('select[name="from"]').trigger("change")})});$("#send-satoshi-dice").on("show",function(a1,a0){var aZ=this;loadScript("wallet/dicegames",function(){try{DICEGame.init($(aZ))}catch(a2){h.makeNotice("error","misc-error","Unable To Load Dice Bets")}},function(a2){h.makeNotice("error","misc-error",a2)})});$("#shared-coin").on("show",function(a1,a0){var aZ=$(this);loadScript("wallet/sharedcoin",function(){try{r(aZ);SharedCoin.init(aZ)}catch(a2){console.log(a2);h.makeNotice("error","misc-error",a2)}},function(a2){h.makeNotice("error","misc-error",a2)})});$("#send-sms").on("show",function(a1,a0){if(a0){return}var aZ=$(this);r(aZ);$.ajax({type:"GET",url:resource+"wallet/country_codes.html",success:function(a2){aZ.find('select[name="sms-country-code"]').html(a2)},error:function(){h.makeNotice("error","misc-error","Error Downloading SMS Country Codes")}});aZ.find(".send").unbind().click(function(){loadScript("wallet/signer",function(){var a2=initNewTx();startTxUI(aZ,"sms",a2)})})});$("#address-book").on("show",function(){var a0=$("#address-book-tbl tbody");if(aI(g)>0){a0.empty();for(var aZ in g){var a1=$("<tr><td>"+g[aZ]+'</td><td><div class="addr-book-entry">'+aZ+'</div></td><td style="width:16px" class="hidden-phone"><img src="'+resource+'delete.png" class="act-delete" /></td></tr>');(function(a2){a1.find(".act-delete").click(function(){h.deleteAddressBook(a2)})})(aZ);a0.append(a1)}}});$('a[data-toggle="tab"]').unbind().on("show",function(aZ){$(aZ.target.hash).trigger("show")});$("#receive-coins-btn").click(function(){ai($("#receive-coins"))});$("#cash-into-coins").click(function(){$(this).attr("href",$(this).attr("href")+h.getPreferredAddress())});$(".show_adv").click(function(){$(".modal:visible").center()});$(".download-backup-btn").show();aG()}function p(){$(".resend-code").click(function(){h.setGUID(O,true)});$("#reset-two-factor-btn").click(function(){h.openWindow(root+"wallet/reset-two-factor"+(O?"?guid="+O:""))});$(".recover-wallet-btn").click(function(){h.openWindow(root+"wallet/forgot-password"+(O?"?guid="+O:""))});$(".download-backup-btn").toggle(al!=null).click(function(){if(!al){h.makeNotice("error","error","No Wallet Data to Download");return}try{var a0=!!new Blob()}catch(a1){}if(a0){loadScript("wallet/filesaver",function(){var a2=new Blob([al],{type:"text/plain;charset=utf-8"});saveAs(a2,"wallet.aes.json")})}else{var aZ=window.open(null,null,"width=700,height=800,toolbar=0");aZ.document.write('<!DOCTYPE html><html><head></head><body><div style="word-wrap:break-word;" >'+al+"</div></body></html>")}aW()});$(".auth-0,.auth-1,.auth-2,.auth-3,.auth-4,.auth-5").unbind().keypress(function(aZ){if(aZ.keyCode==13){aZ.preventDefault();$("#restore-wallet-continue").click()}});$("#restore-wallet-continue").unbind().click(function(a0){a0.preventDefault();var aZ=$.trim($("#restore-guid").val());if(aZ.length==0){return}if(O!=aZ){h.setGUID(aZ,false)}else{a()}});$(".modal").on("show",function(){N();$(this).center()}).on("hidden",function(){var a0=$(".modal:visible");var aZ=$("#notices").remove();if(a0.length>0){a0.find(".modal-body").prepend(aZ)}else{$("#main-notices-container").append(aZ)}}).on("shown",function(){N();var aZ=$(this);setTimeout(function(){if(aZ.is(":visible")){aZ.find(".modal-body").prepend($("#notices").remove())}},100);aZ.center()})}function ao(a0){var a1=Crypto.SHA256(a0+"?");switch(a1.slice(0,2)){case"00":var a2=Crypto.SHA256(a0,{asBytes:true});return a2;break;case"01":var aZ=Crypto.util.hexToBytes(a1.slice(2,4))[0];var a3=Math.round(Math.pow(2,(aZ/4)));var a2=Crypto.PBKDF2(a0,"Satoshi Nakamoto",32,{iterations:a3,asBytes:true});return a2;break;default:console.log("invalid key");break}}function aL(){var a1,aZ="";if(window.getSelection){a1=window.getSelection();if(a1.rangeCount){var a2=a1.getRangeAt(0).cloneContents();var a0=document.createElement("div");a0.appendChild(a2);aZ=a0.innerText}}else{if(document.selection&&document.selection.type=="Text"){aZ=document.selection.createRange().htmlText}}return aZ}this.detectPrivateKeyFormat=function(a0){if(/^5[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{50}$/.test(a0)){return"sipa"}if(/^[LK][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(a0)){return"compsipa"}if(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{44}$/.test(a0)||/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{43}$/.test(a0)){return"base58"}if(/^[A-Fa-f0-9]{64}$/.test(a0)){return"hex"}if(/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(a0)){return"base64"}if(/^6P[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{56}$/.test(a0)){return"bip38"}if(/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(a0)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(a0)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(a0)||/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{30}$/.test(a0)){var aZ=Crypto.SHA256(a0+"?",{asBytes:true});if(aZ[0]===0||aZ[0]===1){return"mini"}}throw"Unknown Key Format "+a0};this.privateKeyStringToKey=function(a0,a2){var aZ=null;if(a2=="base58"){aZ=B58.decode(a0)}else{if(a2=="base64"){aZ=Crypto.util.base64ToBytes(a0)}else{if(a2=="hex"){aZ=Crypto.util.hexToBytes(a0)}else{if(a2=="mini"){aZ=ao(a0)}else{if(a2=="sipa"){var a1=B58.decode(a0);a1.shift();aZ=a1.slice(0,a1.length-4)}else{if(a2=="compsipa"){var a1=B58.decode(a0);a1.shift();a1.pop();aZ=a1.slice(0,a1.length-4)}else{throw"Unsupported Key Format"}}}}}}if(aZ.length!=32){throw"Result not 32 bytes in length"}return new Bitcoin.ECKey(aZ)};$(document).ready(function(){if(!$.isEmptyObject({})){h.makeNotice("error","error","Object.prototype has been extended by a browser extension. Please disable this extensions and reload the page.");return}$("input,button,select").attr("autocomplete","off");var a3=$(document.body);function a4(){if(O&&O.length==36){setTimeout(function(){h.setGUID(O,false)},10)}else{$("#signup-btn").show()}}O=a3.data("guid");d=a3.data("sharedkey");Z=a3.data("language");if(h.skip_init){return}var a5=1;function a2(){--a5;if(a5==-1){p()}}MyStore.get("payload",function(a8){if(!al&&a8){al=a8;aD=ak()}a2()});MyStore.get("server_time_offset",function(a8){aP=parseInt(a8);if(isNaN(aP)){aP=0}});if((!O||O.length==0)&&(isExtension||window.location.href.indexOf("/login")>0)){++a5;MyStore.get("guid",function(a8){O=a8;a4();a2()})}else{a4()}if(top.location!=self.location){top.location=self.location.href}a3.click(function(){if(W){clearTimeout(W);W=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).keypress(function(){if(W){clearTimeout(W);W=setTimeout(h.logout,h.getLogoutTime())}rng_seed_time()}).mousemove(function(a8){if(a8){rng_seed_int(a8.clientX*a8.clientY)}});a2();$(".auth-"+q).show();j=$("#restore-wallet");j.show();var a7=false;var a0=17,a1=86,aZ=67,a6=67;$(document).keydown(function(a9){try{if(a9.keyCode==a0||a9.keyCode==a6){a7=true}if(a7&&a9.keyCode==aZ){var a8=$.trim(aL());var ba=K[a8];if(ba!=null){if(ba.priv==null){$("#watch-only-copy-warning-modal").modal("show")}else{if(ba.tag==1){Q()}}}}}catch(a9){console.log(a9)}}).keyup(function(a8){if(a8.keyCode==a0||a8.keyCode==a6){a7=false}}).ajaxStart(function(){ax("loading_start");$(".loading-indicator").fadeIn(200)}).ajaxStop(function(){ax("loading_stop");$(".loading-indicator").hide()})});function aY(){$("#receive-coins").find(".tab-pane.active").trigger("show");setupToggle()}};