function showAddressModalMenu(b){var c=addresses[b];if(c==null){makeNotice("error","misc-error","Address Not Found");return}var a=$("#address-modal");a.modal({keyboard:true,backdrop:"static",show:true});a.find(".address").text(b);if(c.tag==2){a.find(".address-archive-button").hide()}if(c.priv==null){a.find(".address-sign-message").hide()}a.find(".btn.btn-secondary").unbind().click(function(){a.modal("hide")});a.find(".address-label-button").unbind().click(function(){a.modal("hide");labelAddressModal(b)});a.find(".address-qr-code-button").unbind().click(function(){a.modal("hide");showAddressModalQRCode(b)});a.find(".address-sign-message").unbind().click(function(){a.modal("hide");showAddressModalSignMessage(b)});a.find(".address-archive-button").unbind().click(function(){a.modal("hide");archiveAddr(b)})}function showAddressModalQRCode(b){var a=$("#qr-code-modal");a.modal({keyboard:true,backdrop:"static",show:true});a.find(".address").text(b);loadScript(resource+"wallet/qr.code.creator.js",function(){var c=makeQRCode(300,300,1,b);a.find(".address-qr-code").empty().append(c)});a.find(".address").text(b);a.find(".btn.btn-secondary").unbind().click(function(){a.modal("hide")})}function verifyMessageModal(){var a=$("#verify-message-modal");a.modal({keyboard:true,backdrop:"static",show:true});console.log("Verify Message");a.find(".address-result").hide();var b=a.find('textarea[name="message"]');var c=a.find('textarea[name="signature"]');a.find(".btn.btn-secondary").unbind().click(function(){a.modal("hide")});a.find("textarea").bind("change",function(){a.find(".address-result").hide()});a.find(".btn.btn-primary").unbind().click(function(){try{var g=$.trim(b.val());if(!g||g.length==0){makeNotice("error","misc-error","You Must Enter A Message To Verify");return}var h=$.trim(c.val());if(!h||h.length==0){makeNotice("error","misc-error","You Must Enter A Signature To Verify");return}console.log(g+" "+h);var f=Bitcoin.Message.verifyMessage(h,g);a.find(".address-result-txt").text(f);a.find(".address-result").show(200)}catch(d){makeNotice("error","misc-error","Error Verifying Message"+d);a.modal("hide");return}})}function showAddressModalSignMessage(a){getSecondPassword(function(){var b=$("#sign-message-modal");b.modal({keyboard:true,backdrop:"static",show:true});b.find(".signature").hide();var c=b.find('textarea[name="message"]');b.find(".address").text(a);b.find(".btn.btn-secondary").unbind().click(function(){b.modal("hide")});c.bind("change",function(){b.find(".signature").hide()});b.find(".btn.btn-primary").unbind().click(function(){var g=addresses[a];if(!g||!g.priv){b.modal("hide");return}var f=$.trim(c.val());if(!f||f.length==0){makeNotice("error","misc-error","You Must Enter A Message To Sign");return}var e=decodePK(g.priv);var d=new Bitcoin.ECKey(e);var h=Bitcoin.Message.signMessage(d,f,g.addr);b.find(".signature").show(200);b.find(".signature-result").text(h)})})}function labelAddressModal(b){var a=$("#label-address-modal");a.modal({keyboard:true,backdrop:"static",show:true});a.find(".address").text(b);var c=a.find('input[name="label"]');a.find(".address").text(b);c.val("");a.find(".btn.btn-primary").unbind().click(function(){a.modal("hide");var d=c.val();if(d.length==0){makeNotice("error","misc-error","you must enter a label for the address");return false}addresses[b].label=d;backupWalletDelayed();buildVisibleView()});a.find(".btn.btn-secondary").unbind().click(function(){a.modal("hide")})};